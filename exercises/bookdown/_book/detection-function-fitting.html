<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Intermediate distance sampling workshop - St Andrews 2017</title>
  <meta name="description" content="Intermediate distance sampling workshop - St Andrews 2017">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="Intermediate distance sampling workshop - St Andrews 2017" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Intermediate distance sampling workshop - St Andrews 2017" />
  
  
  

<meta name="author" content="Laura Marshall, David L. Miller and Len Thomas">


<meta name="date" content="2017-07-03">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="preparing-data-for-analysis.html">
<link rel="next" href="simple-density-surface-models.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="details.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html"><i class="fa fa-check"></i><b>1</b> A hands on introduction to R tutorial</a><ul>
<li class="chapter" data-level="1.1" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#introduction-to-rstudio"><i class="fa fa-check"></i><b>1.2</b> Introduction to RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#a-first-session-in-rstudio"><i class="fa fa-check"></i><b>1.3</b> A first session in RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#Types-classes"><i class="fa fa-check"></i><b>1.4</b> Types and classes of objects</a></li>
<li class="chapter" data-level="1.5" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#subsetting-data"><i class="fa fa-check"></i><b>1.5</b> Subsetting data</a></li>
<li class="chapter" data-level="1.6" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#mathematical-functions-and-simple-data-calculations"><i class="fa fa-check"></i><b>1.6</b> Mathematical functions and simple data calculations</a></li>
<li class="chapter" data-level="1.7" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#importing-and-exporting-data"><i class="fa fa-check"></i><b>1.7</b> Importing and exporting data</a></li>
<li class="chapter" data-level="1.8" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#graphics"><i class="fa fa-check"></i><b>1.8</b> Graphics</a></li>
<li class="chapter" data-level="1.9" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#extending-basic-capabilities-via-packages"><i class="fa fa-check"></i><b>1.9</b> Extending basic capabilities via packages</a></li>
<li class="chapter" data-level="1.10" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#linear-regression"><i class="fa fa-check"></i><b>1.10</b> Linear regression</a></li>
<li class="chapter" data-level="1.11" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#some-advanced-capabilities-of-r"><i class="fa fa-check"></i><b>1.11</b> Some advanced capabilities of R</a><ul>
<li class="chapter" data-level="1.11.1" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#simulation-and-random-number-generation"><i class="fa fa-check"></i><b>1.11.1</b> Simulation and random number generation</a></li>
<li class="chapter" data-level="1.11.2" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#writing-your-own-functions"><i class="fa fa-check"></i><b>1.11.2</b> Writing your own functions</a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#wrap-up"><i class="fa fa-check"></i><b>1.12</b> Wrap up</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="analyse-simulated-data-set.html"><a href="analyse-simulated-data-set.html"><i class="fa fa-check"></i><b>2</b> analyse simulated data set</a><ul>
<li class="chapter" data-level="2.1" data-path="analyse-simulated-data-set.html"><a href="analyse-simulated-data-set.html#laura-to-prepare"><i class="fa fa-check"></i><b>2.1</b> Laura to prepare</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="problem-datasets.html"><a href="problem-datasets.html"><i class="fa fa-check"></i><b>3</b> Problem datasets</a><ul>
<li class="chapter" data-level="3.1" data-path="problem-datasets.html"><a href="problem-datasets.html#len-to-prepare"><i class="fa fa-check"></i><b>3.1</b> Len to prepare</a><ul>
<li class="chapter" data-level="3.1.1" data-path="problem-datasets.html"><a href="problem-datasets.html#blue-monkey-data-set"><i class="fa fa-check"></i><b>3.1.1</b> Blue monkey data set</a></li>
<li class="chapter" data-level="3.1.2" data-path="problem-datasets.html"><a href="problem-datasets.html#odd-spike-data-set"><i class="fa fa-check"></i><b>3.1.2</b> Odd spike data set</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simulation-of-distance-sampling-data.html"><a href="simulation-of-distance-sampling-data.html"><i class="fa fa-check"></i><b>4</b> Simulation of distance sampling data</a><ul>
<li class="chapter" data-level="4.1" data-path="simulation-of-distance-sampling-data.html"><a href="simulation-of-distance-sampling-data.html#laura-to-prepare-1"><i class="fa fa-check"></i><b>4.1</b> Laura to prepare</a></li>
<li class="chapter" data-level="4.2" data-path="simulation-of-distance-sampling-data.html"><a href="simulation-of-distance-sampling-data.html#bit-of-exposure-to-survey-design-engine"><i class="fa fa-check"></i><b>4.2</b> Bit of exposure to survey design engine</a></li>
<li class="chapter" data-level="4.3" data-path="simulation-of-distance-sampling-data.html"><a href="simulation-of-distance-sampling-data.html#trailsno-trails-exercise-from-previous-years"><i class="fa fa-check"></i><b>4.3</b> Trails/no trails exercise from previous years</a></li>
<li class="chapter" data-level="4.4" data-path="simulation-of-distance-sampling-data.html"><a href="simulation-of-distance-sampling-data.html#perhaps-some-exposure-to-dssim-vignette"><i class="fa fa-check"></i><b>4.4</b> Perhaps some exposure to DSsim vignette</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="preparing-data-for-analysis.html"><a href="preparing-data-for-analysis.html"><i class="fa fa-check"></i><b>5</b> Preparing data for analysis</a><ul>
<li class="chapter" data-level="5.1" data-path="preparing-data-for-analysis.html"><a href="preparing-data-for-analysis.html#aims"><i class="fa fa-check"></i><b>5.1</b> Aims</a></li>
<li class="chapter" data-level="5.2" data-path="preparing-data-for-analysis.html"><a href="preparing-data-for-analysis.html#preamble"><i class="fa fa-check"></i><b>5.2</b> Preamble</a></li>
<li class="chapter" data-level="5.3" data-path="preparing-data-for-analysis.html"><a href="preparing-data-for-analysis.html#load-and-arrange-data"><i class="fa fa-check"></i><b>5.3</b> Load and arrange data</a><ul>
<li class="chapter" data-level="5.3.1" data-path="preparing-data-for-analysis.html"><a href="preparing-data-for-analysis.html#segment-data"><i class="fa fa-check"></i><b>5.3.1</b> Segment data</a></li>
<li class="chapter" data-level="5.3.2" data-path="preparing-data-for-analysis.html"><a href="preparing-data-for-analysis.html#observation-data"><i class="fa fa-check"></i><b>5.3.2</b> Observation data</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="preparing-data-for-analysis.html"><a href="preparing-data-for-analysis.html#save-the-data"><i class="fa fa-check"></i><b>5.4</b> Save the data</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html"><i class="fa fa-check"></i><b>6</b> Detection function fitting</a><ul>
<li class="chapter" data-level="6.1" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#aims-1"><i class="fa fa-check"></i><b>6.1</b> Aims</a></li>
<li class="chapter" data-level="6.2" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#preamble-1"><i class="fa fa-check"></i><b>6.2</b> Preamble</a></li>
<li class="chapter" data-level="6.3" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#load-the-data"><i class="fa fa-check"></i><b>6.3</b> Load the data</a></li>
<li class="chapter" data-level="6.4" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#exploratory-analysis"><i class="fa fa-check"></i><b>6.4</b> Exploratory analysis</a><ul>
<li class="chapter" data-level="6.4.1" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#distances"><i class="fa fa-check"></i><b>6.4.1</b> Distances</a></li>
<li class="chapter" data-level="6.4.2" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#size-and-distance"><i class="fa fa-check"></i><b>6.4.2</b> Size and distance</a></li>
<li class="chapter" data-level="6.4.3" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#distance-and-sea-state"><i class="fa fa-check"></i><b>6.4.3</b> Distance and sea state</a></li>
<li class="chapter" data-level="6.4.4" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#survey-effect"><i class="fa fa-check"></i><b>6.4.4</b> Survey effect</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#fitting-detection-functions"><i class="fa fa-check"></i><b>6.5</b> Fitting detection functions</a><ul>
<li class="chapter" data-level="6.5.1" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#summaries"><i class="fa fa-check"></i><b>6.5.1</b> Summaries</a></li>
<li class="chapter" data-level="6.5.2" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#goodness-of-fit"><i class="fa fa-check"></i><b>6.5.2</b> Goodness of fit</a></li>
<li class="chapter" data-level="6.5.3" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#plotting"><i class="fa fa-check"></i><b>6.5.3</b> Plotting</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#now-you-try"><i class="fa fa-check"></i><b>6.6</b> Now you try…</a></li>
<li class="chapter" data-level="6.7" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#model-selection"><i class="fa fa-check"></i><b>6.7</b> Model selection</a><ul>
<li class="chapter" data-level="6.7.1" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#estimating-abundance"><i class="fa fa-check"></i><b>6.7.1</b> Estimating abundance</a></li>
<li class="chapter" data-level="6.7.2" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#save-model-objects"><i class="fa fa-check"></i><b>6.7.2</b> Save model objects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html"><i class="fa fa-check"></i><b>7</b> Simple density surface models</a><ul>
<li class="chapter" data-level="7.1" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html#aims-2"><i class="fa fa-check"></i><b>7.1</b> Aims</a></li>
<li class="chapter" data-level="7.2" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html#load-the-packages-and-data"><i class="fa fa-check"></i><b>7.2</b> Load the packages and data</a></li>
<li class="chapter" data-level="7.3" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html#pre-model-fitting"><i class="fa fa-check"></i><b>7.3</b> Pre-model fitting</a></li>
<li class="chapter" data-level="7.4" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html#fitting-dsms"><i class="fa fa-check"></i><b>7.4</b> Fitting DSMs</a><ul>
<li class="chapter" data-level="7.4.1" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html#visualising-output"><i class="fa fa-check"></i><b>7.4.1</b> Visualising output</a></li>
<li class="chapter" data-level="7.4.2" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html#checking-the-model"><i class="fa fa-check"></i><b>7.4.2</b> Checking the model</a></li>
<li class="chapter" data-level="7.4.3" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html#setting-basis-complexity"><i class="fa fa-check"></i><b>7.4.3</b> Setting basis complexity</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html#estimated-abundance-as-response"><i class="fa fa-check"></i><b>7.5</b> Estimated abundance as response</a></li>
<li class="chapter" data-level="7.6" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html#univariate-models"><i class="fa fa-check"></i><b>7.6</b> Univariate models</a></li>
<li class="chapter" data-level="7.7" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html#tweedie-response-distribution"><i class="fa fa-check"></i><b>7.7</b> Tweedie response distribution</a></li>
<li class="chapter" data-level="7.8" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html#save-models"><i class="fa fa-check"></i><b>7.8</b> Save models</a></li>
<li class="chapter" data-level="7.9" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html#extra-credit"><i class="fa fa-check"></i><b>7.9</b> Extra credit</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html"><i class="fa fa-check"></i><b>8</b> Advanced density surface models</a><ul>
<li class="chapter" data-level="8.1" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#aims-3"><i class="fa fa-check"></i><b>8.1</b> Aims</a></li>
<li class="chapter" data-level="8.2" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#load-data-and-packages"><i class="fa fa-check"></i><b>8.2</b> Load data and packages</a></li>
<li class="chapter" data-level="8.3" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#exploratory-analysis-1"><i class="fa fa-check"></i><b>8.3</b> Exploratory analysis</a></li>
<li class="chapter" data-level="8.4" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#pre-model-fitting-1"><i class="fa fa-check"></i><b>8.4</b> Pre-model fitting</a></li>
<li class="chapter" data-level="8.5" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#our-new-friend"><i class="fa fa-check"></i><b>8.5</b> Our new friend <code>+</code></a><ul>
<li class="chapter" data-level="8.5.1" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#plot"><i class="fa fa-check"></i><b>8.5.1</b> Plot</a></li>
<li class="chapter" data-level="8.5.2" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#check"><i class="fa fa-check"></i><b>8.5.2</b> Check</a></li>
<li class="chapter" data-level="8.5.3" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#select-terms"><i class="fa fa-check"></i><b>8.5.3</b> Select terms</a></li>
<li class="chapter" data-level="8.5.4" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#compare-response-distributions"><i class="fa fa-check"></i><b>8.5.4</b> Compare response distributions</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#estimated-abundance-as-a-response"><i class="fa fa-check"></i><b>8.6</b> Estimated abundance as a response</a></li>
<li class="chapter" data-level="8.7" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#concurvity"><i class="fa fa-check"></i><b>8.7</b> Concurvity</a></li>
<li class="chapter" data-level="8.8" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#sensitivity"><i class="fa fa-check"></i><b>8.8</b> Sensitivity</a><ul>
<li class="chapter" data-level="8.8.1" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#compare-bivariate-and-additive-spatial-effects"><i class="fa fa-check"></i><b>8.8.1</b> Compare bivariate and additive spatial effects</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#comparing-models"><i class="fa fa-check"></i><b>8.9</b> Comparing models</a></li>
<li class="chapter" data-level="8.10" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#saving-models"><i class="fa fa-check"></i><b>8.10</b> Saving models</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="prediction-using-fitted-density-surface-models.html"><a href="prediction-using-fitted-density-surface-models.html"><i class="fa fa-check"></i><b>9</b> Prediction using fitted density surface models</a><ul>
<li class="chapter" data-level="9.1" data-path="prediction-using-fitted-density-surface-models.html"><a href="prediction-using-fitted-density-surface-models.html#aims-4"><i class="fa fa-check"></i><b>9.1</b> Aims</a></li>
<li class="chapter" data-level="9.2" data-path="prediction-using-fitted-density-surface-models.html"><a href="prediction-using-fitted-density-surface-models.html#loading-the-packages-and-data"><i class="fa fa-check"></i><b>9.2</b> Loading the packages and data</a></li>
<li class="chapter" data-level="9.3" data-path="prediction-using-fitted-density-surface-models.html"><a href="prediction-using-fitted-density-surface-models.html#loading-prediction-data"><i class="fa fa-check"></i><b>9.3</b> Loading prediction data</a></li>
<li class="chapter" data-level="9.4" data-path="prediction-using-fitted-density-surface-models.html"><a href="prediction-using-fitted-density-surface-models.html#save-the-prediction-to-a-raster"><i class="fa fa-check"></i><b>9.4</b> Save the prediction to a raster</a></li>
<li class="chapter" data-level="9.5" data-path="prediction-using-fitted-density-surface-models.html"><a href="prediction-using-fitted-density-surface-models.html#save-prediction-grid-to-rdata"><i class="fa fa-check"></i><b>9.5</b> Save prediction grid to <code>RData</code></a></li>
<li class="chapter" data-level="9.6" data-path="prediction-using-fitted-density-surface-models.html"><a href="prediction-using-fitted-density-surface-models.html#extra-credit-1"><i class="fa fa-check"></i><b>9.6</b> Extra credit</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="estimating-precision-of-predictions-from-density-surface-models.html"><a href="estimating-precision-of-predictions-from-density-surface-models.html"><i class="fa fa-check"></i><b>10</b> Estimating precision of predictions from density surface models</a><ul>
<li class="chapter" data-level="10.1" data-path="estimating-precision-of-predictions-from-density-surface-models.html"><a href="estimating-precision-of-predictions-from-density-surface-models.html#aims-5"><i class="fa fa-check"></i><b>10.1</b> Aims</a></li>
<li class="chapter" data-level="10.2" data-path="estimating-precision-of-predictions-from-density-surface-models.html"><a href="estimating-precision-of-predictions-from-density-surface-models.html#load-packages-and-data"><i class="fa fa-check"></i><b>10.2</b> Load packages and data</a></li>
<li class="chapter" data-level="10.3" data-path="estimating-precision-of-predictions-from-density-surface-models.html"><a href="estimating-precision-of-predictions-from-density-surface-models.html#estimation-of-variance"><i class="fa fa-check"></i><b>10.3</b> Estimation of variance</a></li>
<li class="chapter" data-level="10.4" data-path="estimating-precision-of-predictions-from-density-surface-models.html"><a href="estimating-precision-of-predictions-from-density-surface-models.html#summarise-multiple-models"><i class="fa fa-check"></i><b>10.4</b> Summarise multiple models</a></li>
<li class="chapter" data-level="10.5" data-path="estimating-precision-of-predictions-from-density-surface-models.html"><a href="estimating-precision-of-predictions-from-density-surface-models.html#plotting-1"><i class="fa fa-check"></i><b>10.5</b> Plotting</a></li>
<li class="chapter" data-level="10.6" data-path="estimating-precision-of-predictions-from-density-surface-models.html"><a href="estimating-precision-of-predictions-from-density-surface-models.html#save-the-uncertainty-maps-to-raster-files"><i class="fa fa-check"></i><b>10.6</b> Save the uncertainty maps to raster files</a></li>
<li class="chapter" data-level="10.7" data-path="estimating-precision-of-predictions-from-density-surface-models.html"><a href="estimating-precision-of-predictions-from-density-surface-models.html#extra-credit-2"><i class="fa fa-check"></i><b>10.7</b> Extra credit</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="mark-recapture-distance-sampling-of-golftees.html"><a href="mark-recapture-distance-sampling-of-golftees.html"><i class="fa fa-check"></i><b>11</b> Mark-recapture distance sampling of golftees</a><ul>
<li class="chapter" data-level="11.1" data-path="mark-recapture-distance-sampling-of-golftees.html"><a href="mark-recapture-distance-sampling-of-golftees.html#golf-tee-survey"><i class="fa fa-check"></i><b>11.1</b> Golf tee survey</a></li>
<li class="chapter" data-level="11.2" data-path="mark-recapture-distance-sampling-of-golftees.html"><a href="mark-recapture-distance-sampling-of-golftees.html#crabeater-seal-survey"><i class="fa fa-check"></i><b>11.2</b> Crabeater seal survey</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Intermediate distance sampling workshop - St Andrews 2017</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="detection-function-fitting" class="section level1">
<h1><span class="header-section-number">6</span> Detection function fitting</h1>
<div id="aims-1" class="section level2">
<h2><span class="header-section-number">6.1</span> Aims</h2>
<p>By the end of this practical you should feel confident doing the following:</p>
<ul>
<li>Loading data from ArcGIS <code>.gdb</code> files</li>
<li>Working on a <code>data.frame</code> in R to get it into the correct format for <code>Distance</code></li>
<li>Fitting a detection function using <code>ds()</code></li>
<li>Checking detection functions</li>
<li>Making at goodness of fit plots</li>
<li>Selecting models using AIC</li>
<li>Estimating abundance (using R and maths!)</li>
</ul>
</div>
<div id="preamble-1" class="section level2">
<h2><span class="header-section-number">6.2</span> Preamble</h2>
<p>First need to load the requisite R libraries</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rgdal)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(Distance)</code></pre></div>
<pre><code>## Loading required package: mrds</code></pre>
<pre><code>## This is mrds 2.1.18
## Built: R 3.4.0; ; 2017-06-30 11:36:14 UTC; windows</code></pre>
<pre><code>## 
## Attaching package: &#39;Distance&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:mrds&#39;:
## 
##     create.bins</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(knitr)
<span class="kw">library</span>(kableExtra)</code></pre></div>
</div>
<div id="load-the-data" class="section level2">
<h2><span class="header-section-number">6.3</span> Load the data</h2>
<p>The observations are located in a “geodatabase” we created in Arc. We want to pull out the “Sightings” table (called a “layer”) and make it into a <code>data.frame</code> (so it’s easier for R to manipulate).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">distdata &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="st">&quot;Analysis.gdb&quot;</span>, <span class="dt">layer=</span><span class="st">&quot;Sightings&quot;</span>)</code></pre></div>
<pre><code>## OGR data source with driver: OpenFileGDB 
## Source: &quot;Analysis.gdb&quot;, layer: &quot;Sightings&quot;
## with 137 features
## It has 7 fields</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">distdata &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(distdata)</code></pre></div>
<p>We can check it has the correct format using <code>head</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(distdata)</code></pre></div>
<pre><code>##    Survey GroupSize SeaState  Distance        SightingTime SegmentID
## 1 en04395         2      3.0  246.0173 2004/06/28 10:22:21        48
## 2 en04395         2      2.5 1632.3934 2004/06/28 13:18:14        50
## 3 en04395         1      3.0 2368.9941 2004/06/28 14:13:34        51
## 4 en04395         1      3.5  244.6977 2004/06/28 15:06:01        52
## 5 en04395         1      4.0 2081.3468 2004/06/29 10:48:31        56
## 6 en04395         1      2.4 1149.2632 2004/06/29 14:35:33        59
##   SightingID coords.x1 coords.x2
## 1          1   -65.636    39.576
## 2          2   -65.648    39.746
## 3          3   -65.692    39.843
## 4          4   -65.717    39.967
## 5          5   -65.820    40.279
## 6          6   -65.938    40.612</code></pre>
<p>The <code>Distance</code> package expects certain column names to be used. Renaming is much easier to do in R than ArcGIS, so we do it here.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">distdata<span class="op">$</span>distance &lt;-<span class="st"> </span>distdata<span class="op">$</span>Distance
distdata<span class="op">$</span>object &lt;-<span class="st"> </span>distdata<span class="op">$</span>SightingID
distdata<span class="op">$</span>size &lt;-<span class="st"> </span>distdata<span class="op">$</span>GroupSize</code></pre></div>
<p>Let’s see what we did:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(distdata)</code></pre></div>
<pre><code>##    Survey GroupSize SeaState  Distance        SightingTime SegmentID
## 1 en04395         2      3.0  246.0173 2004/06/28 10:22:21        48
## 2 en04395         2      2.5 1632.3934 2004/06/28 13:18:14        50
## 3 en04395         1      3.0 2368.9941 2004/06/28 14:13:34        51
## 4 en04395         1      3.5  244.6977 2004/06/28 15:06:01        52
## 5 en04395         1      4.0 2081.3468 2004/06/29 10:48:31        56
## 6 en04395         1      2.4 1149.2632 2004/06/29 14:35:33        59
##   SightingID coords.x1 coords.x2  distance object size
## 1          1   -65.636    39.576  246.0173      1    2
## 2          2   -65.648    39.746 1632.3934      2    2
## 3          3   -65.692    39.843 2368.9941      3    1
## 4          4   -65.717    39.967  244.6977      4    1
## 5          5   -65.820    40.279 2081.3468      5    1
## 6          6   -65.938    40.612 1149.2632      6    1</code></pre>
<p>We now have four “extra” columns.</p>
</div>
<div id="exploratory-analysis" class="section level2">
<h2><span class="header-section-number">6.4</span> Exploratory analysis</h2>
<p>Before setting off fitting detection functions, let’s look at the relationship of various variables in the data.</p>
<p><em>Don’t worry too much about understanding the code that generates these plots at the moment.</em></p>
<div id="distances" class="section level3">
<h3><span class="header-section-number">6.4.1</span> Distances</h3>
<p>Obviously, the most important covariate in a distance sampling analysis is distance itself. We can plot a histogram of the distances to check that (1) we imported the data correctly and (2) it conforms to the usual shape for line transect data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(distdata<span class="op">$</span>distance, <span class="dt">xlab=</span><span class="st">&quot;Distance (m)&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Distance to sperm whale observations&quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:eda-dist"></span>
<img src="_main_files/figure-html/eda-dist-1.png" alt="Distribution of observed perpendicular detection distances." width="672" />
<p class="caption">
Figure 6.1: Distribution of observed perpendicular detection distances.
</p>
</div>
</div>
<div id="size-and-distance" class="section level3">
<h3><span class="header-section-number">6.4.2</span> Size and distance</h3>
<p>We might expect that there will be a relationship between the distance at which we see animals and the size of the groups observed (larger groups are easier to see at larger distances), so let’s plot that to help us visualise the relationship.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot of size versus distance and sea state vs distance, linear model and LOESS smoother overlay</span>

<span class="co"># put the data into a simple format, only selecting what we need</span>
distplot &lt;-<span class="st"> </span>distdata[,<span class="kw">c</span>(<span class="st">&quot;distance&quot;</span>,<span class="st">&quot;size&quot;</span>,<span class="st">&quot;SeaState&quot;</span>)]
<span class="kw">names</span>(distplot) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Distance&quot;</span>, <span class="st">&quot;Size&quot;</span>, <span class="st">&quot;Beaufort&quot;</span>)
<span class="kw">library</span>(reshape2)
<span class="co"># &quot;melt&quot; the data to have only three columns (try head(distplot))</span>
distplot &lt;-<span class="st"> </span><span class="kw">melt</span>(distplot, <span class="dt">id.vars=</span><span class="st">&quot;Distance&quot;</span>, <span class="dt">value.name=</span><span class="st">&quot;covariate&quot;</span>)

<span class="co"># make the plot</span>
p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(distplot, <span class="kw">aes</span>(<span class="dt">x=</span>covariate, <span class="dt">y=</span>Distance)) <span class="op">+</span>
<span class="st">      </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">      </span><span class="kw">facet_wrap</span>(<span class="op">~</span>variable, <span class="dt">scale=</span><span class="st">&quot;free&quot;</span>) <span class="op">+</span>
<span class="st">      </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;loess&quot;</span>, <span class="dt">se=</span><span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">      </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">se=</span><span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">      </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Covariate value&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Distance (m)&quot;</span>)
<span class="kw">print</span>(p)</code></pre></div>
<div class="figure"><span id="fig:eda-covars"></span>
<img src="_main_files/figure-html/eda-covars-1.png" alt="Effect of group size upon detection distances." width="1152" />
<p class="caption">
Figure 6.2: Effect of group size upon detection distances.
</p>
</div>
</div>
<div id="distance-and-sea-state" class="section level3">
<h3><span class="header-section-number">6.4.3</span> Distance and sea state</h3>
<p>We might also expect that increasing sea state would result in a drop in observations. We can plot histograms of distance for each sea state level (making the sea state take only values 0,1,2,4,5 for this).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">distdata<span class="op">$</span>SeaStateCut &lt;-<span class="st"> </span><span class="kw">cut</span>(distdata<span class="op">$</span>SeaState,<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dt">by=</span><span class="dv">1</span>), <span class="dt">include.lowest=</span><span class="ot">TRUE</span>)
p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(distdata) <span class="op">+</span>
<span class="st">      </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(distance)) <span class="op">+</span>
<span class="st">      </span><span class="kw">facet_wrap</span>(<span class="op">~</span>SeaStateCut) <span class="op">+</span>
<span class="st">      </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Distance (m)&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Count&quot;</span>)
<span class="kw">print</span>(p)</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="figure"><span id="fig:eda-dist-facet-seastate"></span>
<img src="_main_files/figure-html/eda-dist-facet-seastate-1.png" alt="Effect of sea state upon detection distances." width="672" />
<p class="caption">
Figure 6.3: Effect of sea state upon detection distances.
</p>
</div>
</div>
<div id="survey-effect" class="section level3">
<h3><span class="header-section-number">6.4.4</span> Survey effect</h3>
<p>Given we are including data from two different surveys we can also investigate the relationship between survey and distances observed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(distdata) <span class="op">+</span>
<span class="st">      </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(distance)) <span class="op">+</span>
<span class="st">      </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Survey) <span class="op">+</span>
<span class="st">      </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Distance (m)&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Count&quot;</span>)
<span class="kw">print</span>(p)</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="figure"><span id="fig:eda-dist-facet-survey"></span>
<img src="_main_files/figure-html/eda-dist-facet-survey-1.png" alt="Effect of survey upon detection distances." width="672" />
<p class="caption">
Figure 6.4: Effect of survey upon detection distances.
</p>
</div>
</div>
</div>
<div id="fitting-detection-functions" class="section level2">
<h2><span class="header-section-number">6.5</span> Fitting detection functions</h2>
<p>It’s now time to fit some detection function models. We’ll use the <code>ds()</code> function from the <code>Distance</code> package to fit the detection function. You can access the help file for the <code>ds()</code> function by typing <code>?ds</code> – this will give you information about what the different arguments to the function are and what they do.</p>
<p>We can fit a very simple model with the following code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_hn &lt;-<span class="st"> </span><span class="kw">ds</span>(<span class="dt">data=</span>distdata, <span class="dt">truncation=</span><span class="dv">6000</span>, <span class="dt">key=</span><span class="st">&quot;hn&quot;</span>, <span class="dt">adjustment=</span><span class="ot">NULL</span>)</code></pre></div>
<pre><code>## Fitting half-normal key function</code></pre>
<pre><code>## Key only model: not constraining for monotonicity.</code></pre>
<pre><code>## AIC= 2252.06</code></pre>
<pre><code>## No survey area information supplied, only estimating detection function.</code></pre>
<p>Let’s dissect the call and see what each argument means:</p>
<ul>
<li><code>data=distdata</code>: the data to use to fit the model, as we prepared above.</li>
<li><code>truncation=6000</code>: set the truncation distance. Here, observations at distances greater than 6000m will be discarded before fitting the detection function.</li>
<li><code>key=&quot;hn&quot;</code>: the key function to use for the detection function, in this case half-normal (<code>?ds</code> lists the other options).</li>
<li><code>adjustment=NULL</code>: adjustment term series to fit. <code>NULL</code> here means that no adjustments should be fitted (again <code>?ds</code> lists all options).</li>
</ul>
<p>Other useful arguments for this practical are:</p>
<ul>
<li><code>formula=</code>: gives the formula to use for the scale parameter. By default it takes the value <code>~1</code>, meaning the scale parameter is constant and not a function of covariates.</li>
<li><code>order=</code>: specifies the “order” of the adjustments to be used. This is a number (or vector of numbers) specifying the order of the terms. For example <code>order=2</code> fits order 2 adjustments, <code>order=c(2,3)</code> will fit a model with order 2 and 3 adjustments (mathematically, it only makes sense to include order 3 with order 2). By default the value is <code>NULL</code> which has <code>ds()</code> select the number of adjustments by AIC.</li>
</ul>
<div id="summaries" class="section level3">
<h3><span class="header-section-number">6.5.1</span> Summaries</h3>
<p>We can look at the summary of the fitted detection function using the <code>summary()</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(df_hn)</code></pre></div>
<pre><code>## 
## Summary for distance analysis 
## Number of observations :  132 
## Distance range         :  0  -  6000 
## 
## Model : Half-normal key function 
## AIC   : 2252.06 
## 
## Detection function parameters
## Scale coefficient(s):  
##             estimate         se
## (Intercept) 7.900732 0.07884776
## 
##                        Estimate          SE         CV
## Average p             0.5490484  0.03662569 0.06670757
## N in covered region 240.4159539 21.32287581 0.08869160</code></pre>
</div>
<div id="goodness-of-fit" class="section level3">
<h3><span class="header-section-number">6.5.2</span> Goodness of fit</h3>
<p>Goodness of fit quantile-quantile plot and test results can be accessed using the <code>ddf.gof()</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ddf.gof</span>(df_hn<span class="op">$</span>ddf)</code></pre></div>
<div class="figure"><span id="fig:simple-gof"></span>
<img src="_main_files/figure-html/simple-gof-1.png" alt="Goodness of fit QQ plot of half-normal detection function." width="384" />
<p class="caption">
Figure 6.5: Goodness of fit QQ plot of half-normal detection function.
</p>
</div>
<pre><code>## 
## Goodness of fit results for ddf object
## 
## Chi-square tests
##             [0,545] (545,1.09e+03] (1.09e+03,1.64e+03] (1.64e+03,2.18e+03]
## Observed  33.000000    20.00000000        19.000000000            8.000000
## Expected  21.708156    20.84245788        19.213254554           17.005089
## Chisquare  5.873634     0.03405238         0.002366986            4.768669
##           (2.18e+03,2.73e+03] (2.73e+03,3.27e+03] (3.27e+03,3.82e+03]
## Observed             9.000000          13.0000000           14.000000
## Expected            14.450499          11.7899695            9.235669
## Chisquare            2.055842           0.1241881            2.457737
##           (3.82e+03,4.36e+03] (4.36e+03,4.91e+03] (4.91e+03,5.45e+03]
## Observed             3.000000           4.0000000            7.000000
## Expected             6.946241           5.0159948            3.477683
## Chisquare            2.241906           0.2057908            3.567525
##           (5.45e+03,6e+03]     Total
## Observed        2.00000000 132.00000
## Expected        2.31498601 132.00000
## Chisquare       0.04285822  21.37457
## 
## P = 0.011087 with 9 degrees of freedom
## 
## Distance sampling Kolmogorov-Smirnov test
## Test statistic =  0.11192  P =  0.073241 
## 
## Distance sampling Cramer-von Mises test (unweighted)
## Test statistic =  0.39618  P =  0.073947</code></pre>
<p>Note two things here: 1. We use the <code>$ddf</code> element of the detection function object 2. We’re ignoring the <span class="math inline">\(\chi^2\)</span> test results, as they rely on binning the distances to calculate test statistics where as Cramer-von Mises and Kolmogorov-Smirnov tests do not.</p>
</div>
<div id="plotting" class="section level3">
<h3><span class="header-section-number">6.5.3</span> Plotting</h3>
<p>We can plot the models simply using the <code>plot()</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(df_hn)</code></pre></div>
<div class="figure"><span id="fig:simple-plot"></span>
<img src="_main_files/figure-html/simple-plot-1.png" alt="Half-normal detection function." width="672" />
<p class="caption">
Figure 6.6: Half-normal detection function.
</p>
</div>
<p>The dots on the plot indicate the distances where observations are. We can remove them (particularly useful for a model without covariates) using the additional argument <code>showpoints=FALSE</code> (try this out!).</p>
</div>
</div>
<div id="now-you-try" class="section level2">
<h2><span class="header-section-number">6.6</span> Now you try…</h2>
<p>Now try fitting a few models and comparing them using AIC. Don’t try to fit all possible models, just try a selection (say, a hazard-rate, a model with adjustments and a couple with different covariates). You can also try out changing the truncation distance.</p>
<p>Here’s an example to work from. Some tips before you start:</p>
<ul>
<li>You can include as many lines as you like in a given chunk (though you may find it more manageable to separate them up, remembering each time to give the chunk a unique name).</li>
<li>You can run the current line of code in RStudio by hitting <code>Control+Enter</code> (on Windows/Linux; <code>Command+Enter</code> on Mac).</li>
<li>Giving your models informative names will help later on! Here I’m using <code>df_</code> to indicate that this is a detection function, then shortened forms of the model form and covariates, separated by underscores, but use what makes sense to you (and future you!).</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_hr_ss_size &lt;-<span class="st"> </span><span class="kw">ds</span>(distdata, <span class="dt">truncation=</span><span class="dv">6000</span>, <span class="dt">adjustment=</span><span class="ot">NULL</span>, 
                    <span class="dt">key=</span><span class="st">&quot;hr&quot;</span>, <span class="dt">formula=</span><span class="op">~</span>SeaState<span class="op">+</span>size)</code></pre></div>
<pre><code>## Fitting hazard-rate key function</code></pre>
<pre><code>## AIC= 2249.327</code></pre>
<pre><code>## No survey area information supplied, only estimating detection function.</code></pre>
<p>Once you have the hang of writing models and looking at the differences between them, you should move onto the next section.</p>
</div>
<div id="model-selection" class="section level2">
<h2><span class="header-section-number">6.7</span> Model selection</h2>
<p>Looking at the models individually can be a bit unwieldy – it’s nicer to put that data into a table and sort the table by the relevant statistic. The function <code>summarize_ds_models()</code> in the <code>Distance</code> package performs this task for us.</p>
<p>The code below will make a results table with relevant statistics for model selection in it. The <code>summarize_ds_models()</code> function takes a series of object names as its first argument. We can do that with the two models that I fitted like so:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_table &lt;-<span class="st"> </span><span class="kw">summarize_ds_models</span>(df_hn, df_hr_ss_size)
<span class="kw">kable</span>(model_table, <span class="dt">digits=</span><span class="dv">3</span>, <span class="dt">format=</span><span class="st">&quot;latex&quot;</span>, <span class="dt">booktabs=</span><span class="ot">TRUE</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>, <span class="dt">escape=</span><span class="ot">FALSE</span>,
      <span class="dt">caption =</span> <span class="st">&quot;Comparison of half normal and hazard rate with sea state and group size.&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">latex_options=</span><span class="st">&quot;scale_down&quot;</span>)</code></pre></div>

<p>(You can add the models you fitted above into this list.)</p>
<div id="a-further-note-about-model-selection-for-the-sperm-whale-data" class="section level4">
<h4><span class="header-section-number">6.7.0.1</span> A further note about model selection for the sperm whale data</h4>
<p>Note that there is a considerable spike in our distance data. This may be down to observers guarding the trackline (spending too much time searching near zero distance). It’s therefore possible that the hazard-rate model is overfitting to this peak. So we’d like to investigate results from the half-normal model too and see what the effects are on the final spatial models.</p>
</div>
<div id="estimating-abundance" class="section level3">
<h3><span class="header-section-number">6.7.1</span> Estimating abundance</h3>
<p>Just for fun, let’s estimate abundance from these models using a Horvtiz-Thompson-type estimator.</p>
<p>We know the Horvitz-Thompson estimator has the following form: <span class="math display">\[
\hat{N} = \frac{A}{a} \sum_{i=1}^n \frac{s_i}{p_i}
\]</span> we can calculate each part of this equation in R:</p>
<ul>
<li><code>A</code> is the total area of the region we want to estimate abundance for. This was <span class="math inline">\(A=5.285e+11 m^2\)</span>.</li>
<li><code>a</code> is the total area we surveyed. We know that the total transect length was 9,498,474m and the truncation distance. Knowing that <span class="math inline">\(a=2wL\)</span> we can calculate <span class="math inline">\(a\)</span>.</li>
<li><span class="math inline">\(s_i\)</span> are the group sizes, they are stored in <code>df_hn$ddf$data$size</code>.</li>
<li><span class="math inline">\(p_i\)</span> are the probabilities of detection, we can obtain them using <code>predict(df_hn$ddf)$fitted</code>.</li>
</ul>
<p>We know that in general operations are vectorised in R, so calculating <code>c(1, 2, 3)/c(4, 5, 6)</code> will give <code>c(1/4, 2/5, 3/6)</code> so we can just divide the results of getting the <span class="math inline">\(s_i\)</span> and <span class="math inline">\(p_i\)</span> values and then use the <code>sum()</code> function to sum them up.</p>
<p>Try out estimating abundance using the formula below using both <code>df_hn</code> and your favourite model from above:</p>
<p>Note that in the solutions to this exercise (posted on the course website) I show how to use the function <code>dht()</code> to estimate abundance (and uncertainty) for a detection function analysis. This involves some more complex data manipulation steps, so we’ve left it out here in favour of getting to grips with the mathematics.</p>
<div id="accounting-for-perception-bias" class="section level4">
<h4><span class="header-section-number">6.7.1.1</span> Accounting for perception bias</h4>
<p>It’s common, especially in marine surveys, for animals at zero distance to be missed by observers. There are several ways to deal with this issue. For now, we are just going to use a very simply constant correction factor to inflate the abundance.</p>
<p>From <span class="citation">Palka (<a href="#ref-Palka2006">2006</a>)</span>, we think that observations on the track line were such that <span class="math inline">\(g(0)=0.46\)</span>, we can apply that correction to our abundance estimate (in a very primitive way):</p>
<p>This kind of correction works fine when we have a single number to adjust by, in general we’d like to model the perception bias using “mark-recapture distance sampling” techniques.</p>
</div>
</div>
<div id="save-model-objects" class="section level3">
<h3><span class="header-section-number">6.7.2</span> Save model objects</h3>
<p>Save your top few models in an <code>RData</code> file, so we can load them up later on. We’ll also save the distance data we used to fit out models.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">save</span>(df_hn, df_hr_ss_size, <span class="co"># add you models here, followed by commas!</span>
     distdata,
     <span class="dt">file=</span><span class="st">&quot;df-models.RData&quot;</span>)</code></pre></div>
<p>You can check it worked by using the <code>load()</code> function to recover the models.</p>
<!--
### References

Palka, D. (2006). Summer Abundance Estimates of Cetaceans in US North Atlantic Navy Operating Areas. Northeast Fisheries Science Center Reference Document 06-03. [Available online here](http://www.nefsc.noaa.gov/nefsc/publications/crd/crd1229/crd1229.pdf)
-->

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Palka2006">
<p>Palka, Debra L. 2006. “Summer Abundance Estimates of Cetaceans in the Us North Atlantic Operating Areas.” Research report. US Dept of Commerce, Northeast Fisheries Science Center.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="preparing-data-for-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simple-density-surface-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
