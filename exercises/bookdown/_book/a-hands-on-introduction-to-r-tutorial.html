<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Intermediate distance sampling workshop - St Andrews 2017</title>
  <meta name="description" content="Intermediate distance sampling workshop - St Andrews 2017">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="Intermediate distance sampling workshop - St Andrews 2017" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Intermediate distance sampling workshop - St Andrews 2017" />
  
  
  

<meta name="author" content="Laura Marshall, David L. Miller and Len Thomas">


<meta name="date" content="2017-06-29">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">
<link rel="next" href="analyse-simulated-data-set.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="details.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html"><i class="fa fa-check"></i><b>1</b> A hands on introduction to R tutorial</a><ul>
<li class="chapter" data-level="1.1" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#introduction-to-rstudio"><i class="fa fa-check"></i><b>1.2</b> Introduction to RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#a-first-session-in-rstudio"><i class="fa fa-check"></i><b>1.3</b> A first session in RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#Types-classes"><i class="fa fa-check"></i><b>1.4</b> Types and classes of objects</a></li>
<li class="chapter" data-level="1.5" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#subsetting-data"><i class="fa fa-check"></i><b>1.5</b> Subsetting data</a></li>
<li class="chapter" data-level="1.6" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#mathematical-functions-and-simple-data-calculations"><i class="fa fa-check"></i><b>1.6</b> Mathematical functions and simple data calculations</a></li>
<li class="chapter" data-level="1.7" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#importing-and-exporting-data"><i class="fa fa-check"></i><b>1.7</b> Importing and exporting data</a></li>
<li class="chapter" data-level="1.8" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#graphics"><i class="fa fa-check"></i><b>1.8</b> Graphics</a></li>
<li class="chapter" data-level="1.9" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#extending-basic-capabilities-via-packages"><i class="fa fa-check"></i><b>1.9</b> Extending basic capabilities via packages</a></li>
<li class="chapter" data-level="1.10" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#linear-regression"><i class="fa fa-check"></i><b>1.10</b> Linear regression</a></li>
<li class="chapter" data-level="1.11" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#some-advanced-capabilities-of-r"><i class="fa fa-check"></i><b>1.11</b> Some advanced capabilities of R</a><ul>
<li class="chapter" data-level="1.11.1" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#simulation-and-random-number-generation"><i class="fa fa-check"></i><b>1.11.1</b> Simulation and random number generation</a></li>
<li class="chapter" data-level="1.11.2" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#writing-your-own-functions"><i class="fa fa-check"></i><b>1.11.2</b> Writing your own functions</a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="a-hands-on-introduction-to-r-tutorial.html"><a href="a-hands-on-introduction-to-r-tutorial.html#wrap-up"><i class="fa fa-check"></i><b>1.12</b> Wrap up</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="analyse-simulated-data-set.html"><a href="analyse-simulated-data-set.html"><i class="fa fa-check"></i><b>2</b> analyse simulated data set</a><ul>
<li class="chapter" data-level="2.1" data-path="analyse-simulated-data-set.html"><a href="analyse-simulated-data-set.html#laura-to-prepare"><i class="fa fa-check"></i><b>2.1</b> Laura to prepare</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="problem-datasets.html"><a href="problem-datasets.html"><i class="fa fa-check"></i><b>3</b> Problem datasets</a><ul>
<li class="chapter" data-level="3.1" data-path="problem-datasets.html"><a href="problem-datasets.html#len-to-prepare"><i class="fa fa-check"></i><b>3.1</b> Len to prepare</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simulation-of-distance-sampling-data.html"><a href="simulation-of-distance-sampling-data.html"><i class="fa fa-check"></i><b>4</b> Simulation of distance sampling data</a><ul>
<li class="chapter" data-level="4.1" data-path="simulation-of-distance-sampling-data.html"><a href="simulation-of-distance-sampling-data.html#laura-to-prepare-1"><i class="fa fa-check"></i><b>4.1</b> Laura to prepare</a></li>
<li class="chapter" data-level="4.2" data-path="simulation-of-distance-sampling-data.html"><a href="simulation-of-distance-sampling-data.html#bit-of-exposure-to-survey-design-engine"><i class="fa fa-check"></i><b>4.2</b> Bit of exposure to survey design engine</a></li>
<li class="chapter" data-level="4.3" data-path="simulation-of-distance-sampling-data.html"><a href="simulation-of-distance-sampling-data.html#trailsno-trails-exercise-from-previous-years"><i class="fa fa-check"></i><b>4.3</b> Trails/no trails exercise from previous years</a></li>
<li class="chapter" data-level="4.4" data-path="simulation-of-distance-sampling-data.html"><a href="simulation-of-distance-sampling-data.html#perhaps-some-exposure-to-dssim-vignette"><i class="fa fa-check"></i><b>4.4</b> Perhaps some exposure to DSsim vignette</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="preparing-data-for-analysis.html"><a href="preparing-data-for-analysis.html"><i class="fa fa-check"></i><b>5</b> Preparing data for analysis</a><ul>
<li class="chapter" data-level="5.1" data-path="preparing-data-for-analysis.html"><a href="preparing-data-for-analysis.html#aims"><i class="fa fa-check"></i><b>5.1</b> Aims</a></li>
<li class="chapter" data-level="5.2" data-path="preparing-data-for-analysis.html"><a href="preparing-data-for-analysis.html#preamble"><i class="fa fa-check"></i><b>5.2</b> Preamble</a></li>
<li class="chapter" data-level="5.3" data-path="preparing-data-for-analysis.html"><a href="preparing-data-for-analysis.html#load-and-arrange-data"><i class="fa fa-check"></i><b>5.3</b> Load and arrange data</a><ul>
<li class="chapter" data-level="5.3.1" data-path="preparing-data-for-analysis.html"><a href="preparing-data-for-analysis.html#segment-data"><i class="fa fa-check"></i><b>5.3.1</b> Segment data</a></li>
<li class="chapter" data-level="5.3.2" data-path="preparing-data-for-analysis.html"><a href="preparing-data-for-analysis.html#observation-data"><i class="fa fa-check"></i><b>5.3.2</b> Observation data</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="preparing-data-for-analysis.html"><a href="preparing-data-for-analysis.html#save-the-data"><i class="fa fa-check"></i><b>5.4</b> Save the data</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html"><i class="fa fa-check"></i><b>6</b> Detection function fitting</a><ul>
<li class="chapter" data-level="6.1" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#aims-1"><i class="fa fa-check"></i><b>6.1</b> Aims</a></li>
<li class="chapter" data-level="6.2" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#preamble-1"><i class="fa fa-check"></i><b>6.2</b> Preamble</a></li>
<li class="chapter" data-level="6.3" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#load-the-data"><i class="fa fa-check"></i><b>6.3</b> Load the data</a></li>
<li class="chapter" data-level="6.4" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#exploratory-analysis"><i class="fa fa-check"></i><b>6.4</b> Exploratory analysis</a><ul>
<li class="chapter" data-level="6.4.1" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#distances"><i class="fa fa-check"></i><b>6.4.1</b> Distances</a></li>
<li class="chapter" data-level="6.4.2" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#size-and-distance"><i class="fa fa-check"></i><b>6.4.2</b> Size and distance</a></li>
<li class="chapter" data-level="6.4.3" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#distance-and-sea-state"><i class="fa fa-check"></i><b>6.4.3</b> Distance and sea state</a></li>
<li class="chapter" data-level="6.4.4" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#survey-effect"><i class="fa fa-check"></i><b>6.4.4</b> Survey effect</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#fitting-detection-functions"><i class="fa fa-check"></i><b>6.5</b> Fitting detection functions</a><ul>
<li class="chapter" data-level="6.5.1" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#summaries"><i class="fa fa-check"></i><b>6.5.1</b> Summaries</a></li>
<li class="chapter" data-level="6.5.2" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#goodness-of-fit"><i class="fa fa-check"></i><b>6.5.2</b> Goodness of fit</a></li>
<li class="chapter" data-level="6.5.3" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#plotting"><i class="fa fa-check"></i><b>6.5.3</b> Plotting</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#now-you-try"><i class="fa fa-check"></i><b>6.6</b> Now you try…</a></li>
<li class="chapter" data-level="6.7" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#model-selection"><i class="fa fa-check"></i><b>6.7</b> Model selection</a><ul>
<li class="chapter" data-level="6.7.1" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#estimating-abundance"><i class="fa fa-check"></i><b>6.7.1</b> Estimating abundance</a></li>
<li class="chapter" data-level="6.7.2" data-path="detection-function-fitting.html"><a href="detection-function-fitting.html#save-model-objects"><i class="fa fa-check"></i><b>6.7.2</b> Save model objects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html"><i class="fa fa-check"></i><b>7</b> Simple density surface models</a><ul>
<li class="chapter" data-level="7.1" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html#aims-2"><i class="fa fa-check"></i><b>7.1</b> Aims</a></li>
<li class="chapter" data-level="7.2" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html#load-the-packages-and-data"><i class="fa fa-check"></i><b>7.2</b> Load the packages and data</a></li>
<li class="chapter" data-level="7.3" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html#pre-model-fitting"><i class="fa fa-check"></i><b>7.3</b> Pre-model fitting</a></li>
<li class="chapter" data-level="7.4" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html#fitting-dsms"><i class="fa fa-check"></i><b>7.4</b> Fitting DSMs</a><ul>
<li class="chapter" data-level="7.4.1" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html#visualising-output"><i class="fa fa-check"></i><b>7.4.1</b> Visualising output</a></li>
<li class="chapter" data-level="7.4.2" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html#checking-the-model"><i class="fa fa-check"></i><b>7.4.2</b> Checking the model</a></li>
<li class="chapter" data-level="7.4.3" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html#setting-basis-complexity"><i class="fa fa-check"></i><b>7.4.3</b> Setting basis complexity</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html#estimated-abundance-as-response"><i class="fa fa-check"></i><b>7.5</b> Estimated abundance as response</a></li>
<li class="chapter" data-level="7.6" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html#univariate-models"><i class="fa fa-check"></i><b>7.6</b> Univariate models</a></li>
<li class="chapter" data-level="7.7" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html#tweedie-response-distribution"><i class="fa fa-check"></i><b>7.7</b> Tweedie response distribution</a></li>
<li class="chapter" data-level="7.8" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html#save-models"><i class="fa fa-check"></i><b>7.8</b> Save models</a></li>
<li class="chapter" data-level="7.9" data-path="simple-density-surface-models.html"><a href="simple-density-surface-models.html#extra-credit"><i class="fa fa-check"></i><b>7.9</b> Extra credit</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html"><i class="fa fa-check"></i><b>8</b> Advanced density surface models</a><ul>
<li class="chapter" data-level="8.1" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#aims-3"><i class="fa fa-check"></i><b>8.1</b> Aims</a></li>
<li class="chapter" data-level="8.2" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#load-data-and-packages"><i class="fa fa-check"></i><b>8.2</b> Load data and packages</a></li>
<li class="chapter" data-level="8.3" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#exploratory-analysis-1"><i class="fa fa-check"></i><b>8.3</b> Exploratory analysis</a></li>
<li class="chapter" data-level="8.4" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#pre-model-fitting-1"><i class="fa fa-check"></i><b>8.4</b> Pre-model fitting</a></li>
<li class="chapter" data-level="8.5" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#our-new-friend"><i class="fa fa-check"></i><b>8.5</b> Our new friend <code>+</code></a><ul>
<li class="chapter" data-level="8.5.1" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#plot"><i class="fa fa-check"></i><b>8.5.1</b> Plot</a></li>
<li class="chapter" data-level="8.5.2" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#check"><i class="fa fa-check"></i><b>8.5.2</b> Check</a></li>
<li class="chapter" data-level="8.5.3" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#select-terms"><i class="fa fa-check"></i><b>8.5.3</b> Select terms</a></li>
<li class="chapter" data-level="8.5.4" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#compare-response-distributions"><i class="fa fa-check"></i><b>8.5.4</b> Compare response distributions</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#estimated-abundance-as-a-response"><i class="fa fa-check"></i><b>8.6</b> Estimated abundance as a response</a></li>
<li class="chapter" data-level="8.7" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#concurvity"><i class="fa fa-check"></i><b>8.7</b> Concurvity</a></li>
<li class="chapter" data-level="8.8" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#sensitivity"><i class="fa fa-check"></i><b>8.8</b> Sensitivity</a><ul>
<li class="chapter" data-level="8.8.1" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#compare-bivariate-and-additive-spatial-effects"><i class="fa fa-check"></i><b>8.8.1</b> Compare bivariate and additive spatial effects</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#comparing-models"><i class="fa fa-check"></i><b>8.9</b> Comparing models</a></li>
<li class="chapter" data-level="8.10" data-path="advanced-density-surface-models.html"><a href="advanced-density-surface-models.html#saving-models"><i class="fa fa-check"></i><b>8.10</b> Saving models</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="prediction-using-fitted-density-surface-models.html"><a href="prediction-using-fitted-density-surface-models.html"><i class="fa fa-check"></i><b>9</b> Prediction using fitted density surface models</a><ul>
<li class="chapter" data-level="9.1" data-path="prediction-using-fitted-density-surface-models.html"><a href="prediction-using-fitted-density-surface-models.html#aims-4"><i class="fa fa-check"></i><b>9.1</b> Aims</a></li>
<li class="chapter" data-level="9.2" data-path="prediction-using-fitted-density-surface-models.html"><a href="prediction-using-fitted-density-surface-models.html#loading-the-packages-and-data"><i class="fa fa-check"></i><b>9.2</b> Loading the packages and data</a></li>
<li class="chapter" data-level="9.3" data-path="prediction-using-fitted-density-surface-models.html"><a href="prediction-using-fitted-density-surface-models.html#loading-prediction-data"><i class="fa fa-check"></i><b>9.3</b> Loading prediction data</a></li>
<li class="chapter" data-level="9.4" data-path="prediction-using-fitted-density-surface-models.html"><a href="prediction-using-fitted-density-surface-models.html#save-the-prediction-to-a-raster"><i class="fa fa-check"></i><b>9.4</b> Save the prediction to a raster</a></li>
<li class="chapter" data-level="9.5" data-path="prediction-using-fitted-density-surface-models.html"><a href="prediction-using-fitted-density-surface-models.html#save-prediction-grid-to-rdata"><i class="fa fa-check"></i><b>9.5</b> Save prediction grid to <code>RData</code></a></li>
<li class="chapter" data-level="9.6" data-path="prediction-using-fitted-density-surface-models.html"><a href="prediction-using-fitted-density-surface-models.html#extra-credit-1"><i class="fa fa-check"></i><b>9.6</b> Extra credit</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="estimating-precision-of-predictions-from-density-surface-models.html"><a href="estimating-precision-of-predictions-from-density-surface-models.html"><i class="fa fa-check"></i><b>10</b> Estimating precision of predictions from density surface models</a><ul>
<li class="chapter" data-level="10.1" data-path="estimating-precision-of-predictions-from-density-surface-models.html"><a href="estimating-precision-of-predictions-from-density-surface-models.html#aims-5"><i class="fa fa-check"></i><b>10.1</b> Aims</a></li>
<li class="chapter" data-level="10.2" data-path="estimating-precision-of-predictions-from-density-surface-models.html"><a href="estimating-precision-of-predictions-from-density-surface-models.html#load-packages-and-data"><i class="fa fa-check"></i><b>10.2</b> Load packages and data</a></li>
<li class="chapter" data-level="10.3" data-path="estimating-precision-of-predictions-from-density-surface-models.html"><a href="estimating-precision-of-predictions-from-density-surface-models.html#estimation-of-variance"><i class="fa fa-check"></i><b>10.3</b> Estimation of variance</a></li>
<li class="chapter" data-level="10.4" data-path="estimating-precision-of-predictions-from-density-surface-models.html"><a href="estimating-precision-of-predictions-from-density-surface-models.html#summarise-multiple-models"><i class="fa fa-check"></i><b>10.4</b> Summarise multiple models</a></li>
<li class="chapter" data-level="10.5" data-path="estimating-precision-of-predictions-from-density-surface-models.html"><a href="estimating-precision-of-predictions-from-density-surface-models.html#plotting-1"><i class="fa fa-check"></i><b>10.5</b> Plotting</a></li>
<li class="chapter" data-level="10.6" data-path="estimating-precision-of-predictions-from-density-surface-models.html"><a href="estimating-precision-of-predictions-from-density-surface-models.html#save-the-uncertainty-maps-to-raster-files"><i class="fa fa-check"></i><b>10.6</b> Save the uncertainty maps to raster files</a></li>
<li class="chapter" data-level="10.7" data-path="estimating-precision-of-predictions-from-density-surface-models.html"><a href="estimating-precision-of-predictions-from-density-surface-models.html#extra-credit-2"><i class="fa fa-check"></i><b>10.7</b> Extra credit</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="mark-recapture-distance-sampling-of-golftees.html"><a href="mark-recapture-distance-sampling-of-golftees.html"><i class="fa fa-check"></i><b>11</b> Mark-recapture distance sampling of golftees</a><ul>
<li class="chapter" data-level="11.1" data-path="mark-recapture-distance-sampling-of-golftees.html"><a href="mark-recapture-distance-sampling-of-golftees.html#golf-tee-survey"><i class="fa fa-check"></i><b>11.1</b> Golf tee survey</a></li>
<li class="chapter" data-level="11.2" data-path="mark-recapture-distance-sampling-of-golftees.html"><a href="mark-recapture-distance-sampling-of-golftees.html#crabeater-seal-survey"><i class="fa fa-check"></i><b>11.2</b> Crabeater seal survey</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Intermediate distance sampling workshop - St Andrews 2017</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="a-hands-on-introduction-to-r-tutorial" class="section level1">
<h1><span class="header-section-number">1</span> A hands on introduction to R tutorial</h1>
<blockquote>
<p>prepared by Tiago A. Marques, Danielle Harris &amp; Len Thomas</p>
</blockquote>
<hr />
<div id="introduction" class="section level2">
<h2><span class="header-section-number">1.1</span> Introduction</h2>
<p>This tutorial was created as a gentle introduction to the R environment. It does not assume any basic knowledge about R, but some basic programming notions would be desirable.</p>
<p>There is an extensive community revolving around R, and abundant courses, tutorials, books, blogs, list servers, etc, freely available online. We provide here a small list of some of these:</p>
<ul>
<li><a href="http://www.r-project.org">R webpage</a> - the main R webpage, including links to downloading R, manuals, tutorials, dedicated search engines, etc.</li>
<li><a href="http://blog.revolutionanalytics.com/2013/08/google-video-r-tutorials.html">R video tutorials</a> - video how to’s in R</li>
<li><a href="http://www.datamind.org/">Online tutorial</a> - a course with interactive exercises</li>
<li><a href="https://www.datacamp.com/getting-started?step=2&amp;track=r">Online course</a> - DataCamp commercial site</li>
<li><a href="http://cran.r-project.org/doc/contrib/refcard.pdf">Reference card</a> - A very handy list of useful R functions</li>
<li><a href="http://cran.r-project.org/doc/contrib/Short-refcard.pdf">Short reference card</a> - A longer reference card with most commonly used R functions</li>
</ul>
<p>To facilitate the interaction with R we leverage on RStudio, a piece of software which allows users to have at a click’s distance many useful features in R. In the following sections of the tutorial you will be guided through a first session of R via RStudio.</p>
<p>The tutorial is intended to follow a brief presentation about R and RStudio, their interaction and capabilities. It assumes that R and RStudio have been previously installed in the computer you are using. The latest version of both software packages is recommended. Both are free and open source.</p>
</div>
<div id="introduction-to-rstudio" class="section level2">
<h2><span class="header-section-number">1.2</span> Introduction to RStudio</h2>
<p>Most users (except perhaps die-hard command line users) will use some sort of graphical user interface (GUI) to R. While the basic R installation comes with a simple GUI, here we adopt the use of RStudio, which considerably facilitates an introduction to R by providing many shortcuts and convenient features which we introduce next.</p>
<p>A major advantage of RStudio is that it makes it easy for you to type your R code into a script window, which you can easily save, and then send individual lines or blocks of code to the R command line to be acted upon. This way, you have a record of what you have done, in the saved script file, and can easily reproduce it any time you like. We strongly recommend that you save your code script.</p>
<p>Given RStudio has been installed, when you double-click on a R workspace it should open in RStudio<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>. After the presentation on R and RStudio you just sat through, from within RStudio you should be able to know where to find:</p>
<ul>
<li>the command line (bottom left pane<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a>)</li>
<li>the code scripts (top left pane)</li>
<li>the workspace objects (top right pane)</li>
<li>the loaded packages and how to load them (bottom right pane)</li>
<li>the created plots (bottom right pane)</li>
<li>the help files (bottom right pane)</li>
<li>a file navigator system akin to windows explorer (bottom right pane)</li>
</ul>
<p>Note that you can customize the aspect of RStudio (e.g. font size and colours of the smart syntax highlighting scheme) via <code>Tools|Global options</code>.</p>
<p>A very handy feature of RStudio is that you can preview the possible arguments of functions, as well as their description, directly when you are inserting the code. Let’s try doing that. Type say <code>seq()</code> in the command line or the script window and then place the cursor between the parenthesis and press the <code>Tab</code> key… Is this a nice feature or what?</p>
<p>Now we have <em>met</em> RStudio and we know how it can make our life simpler, let’s move on.</p>
</div>
<div id="a-first-session-in-rstudio" class="section level2">
<h2><span class="header-section-number">1.3</span> A first session in RStudio</h2>
<p>We have provided a R workspace named <code>tutorial.Rdata</code>. Open RStudio and then open it by selecting <code>File|Open File</code>. We recommend that you begin by creating a script file (<code>Ctrl+Shift+N</code>, RStudio Shortcut) and use that to save and comment all your code that will be executed during the tutorial. In this way you will have a record of everything you did.</p>
<p>You know that R is ready to receive a command when you see the R prompt on the command line (on the bottom left tab by default in RStudio): “&gt;”. If you type a line of code that is not complete, R presents the “+” character, so that the user knows it expects the conclusion of the current line. Important note: while the prompt “&gt;” and “+” will be shown in this tutorial’s code, you should not try to add either “&gt;” nor “+” to the command line: this is something that R does for you and will complain if you try to do it yourself!<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a></p>
<p>On the top right corner tab, where objects available in the <code>Environment</code> are listed, you can see that in <code>tutorial.Rdata</code> there are only two example objects. These are <code>x1</code> and <code>obj2</code>. We can print an object to the screen by simply typing its name and press enter (despite the fact that currently you can actually see the values on these objects <code>Environment</code> tab - but that is because they are simple objects and the workspace is almost empty. )</p>
<p>R is a very powerful calculator! Try some simple maths, say for example (you need to press enter after each line so that the line is evaluated)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">4</span><span class="op">+</span><span class="dv">3</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">log</span>(<span class="dv">8</span>)</code></pre></div>
<pre><code>## [1] 2.079442</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sin</span>(pi)</code></pre></div>
<pre><code>## [1] 1.224606e-16</code></pre>
<p>Tip: There is actually a simpler way to do sourcing from the script file in RStudio. CTRL-Enter is a keyboard shortcut for “source the current line of code in my script file and move the cursor to the next line”. In general if you like keyboard shortcuts, look in RStudio under the menu ``Help | Keyboard shortcuts“.</p>
<p>At the moment your workspace is almost empty, but we can change that easily by creating new objects. We will create a variable called <code>myvar1</code> which we will assign the value of 4. This is typically done using the assign operator <code>&lt;-</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myvar1 &lt;-<span class="st"> </span><span class="dv">4</span></code></pre></div>
<p>There are typically multiple ways to do the same thing in R, and this is sometimes referred to as a disadvantage. For simplicity, we deliberately avoid presenting the several alternatives for each action, and concentrate on the ones we prefer. This is not the same as saying these are the best, and if you continue to work with R you will likely get used to doing things your way - for now we do it our way!</p>
<p>An object should have been created in your workspace. You can list all objects in a given workspace using</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ls</span>()</code></pre></div>
<pre><code>## [1] &quot;myvar1&quot; &quot;obj2&quot;   &quot;pdf&quot;    &quot;x1&quot;</code></pre>
<p>You can also remove any object by using the <code>rm</code> function, so here we remove <code>myvar1</code>, <code>x1</code> and <code>obj2</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(myvar1,x1,obj2)</code></pre></div>
<p>and hence our workspace is empty again. Note the difference between <code>ls()</code> and <code>rm()</code>. While the first function does not need any arguments, the second requires at least one argument (but can take several). This can be easily seen by checking their help files and noting that <code>rm()</code> needs at least 1 explicit argument while <code>ls()</code> can work with defaults.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">?rm</code></pre></div>
<p>This is a convenient way to obtain more information about a given function. If one does not know what the name of the function might be, one can search for functions containing a given string. The following command lists all the functions with the string “mean” in them.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apropos</span>(<span class="st">&quot;mean&quot;</span>)</code></pre></div>
<pre><code>##  [1] &quot;.colMeans&quot;     &quot;.rowMeans&quot;     &quot;colMeans&quot;      &quot;kmeans&quot;       
##  [5] &quot;mean&quot;          &quot;mean.Date&quot;     &quot;mean.default&quot;  &quot;mean.difftime&quot;
##  [9] &quot;mean.POSIXct&quot;  &quot;mean.POSIXlt&quot;  &quot;rowMeans&quot;      &quot;weighted.mean&quot;</code></pre>
<p>Not surprisingly, most if not all of these functions will be used for some kind of mean calculation. You can look into any one of them using the <code>?</code> as above. We have assigned a number to a variable , but we can actually more generally have vectors (strictly, <code>myvar1</code> was a numeric vector of length 1) containing variables. The following code assigns some numbers to 3 different vectors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="fl">0.12</span>,<span class="dv">4</span>,<span class="op">-</span><span class="dv">22</span>)
x3 &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">8</span>,<span class="dt">by=</span><span class="dv">2</span>)
<span class="co">#and a useful shortcut for sequences with the by argument = 1</span>
x1 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span></code></pre></div>
<p>The function <code>seq</code> is very useful for setting sequences of numbers. The optional arguments <code>length.out</code> and <code>along.with</code> provides extra flexibility.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x1</code></pre></div>
<pre><code>## [1] 1 2 3 4 5</code></pre>
<p>We can use the usual mathematical operators over vectors. A few examples follow:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x1 <span class="op">+</span><span class="st"> </span>x2</code></pre></div>
<pre><code>## [1]   2.00   4.00   3.12   8.00 -17.00</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x4 &lt;-<span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2
x5 &lt;-<span class="st"> </span>x1 <span class="op">-</span><span class="st"> </span>x2
x6 &lt;-<span class="st"> </span>x1 <span class="op">*</span><span class="st"> </span>x2
x7 &lt;-<span class="st"> </span>x1 <span class="op">/</span><span class="st"> </span>x2
x4</code></pre></div>
<pre><code>## [1]   2.00   4.00   3.12   8.00 -17.00</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x5</code></pre></div>
<pre><code>## [1]  0.00  0.00  2.88  0.00 27.00</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x6</code></pre></div>
<pre><code>## [1]    1.00    4.00    0.36   16.00 -110.00</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x7</code></pre></div>
<pre><code>## [1]  1.0000000  1.0000000 25.0000000  1.0000000 -0.2272727</code></pre>
<p>Note that if the vectors are of the same length, R performs the operation element-wise. Another useful feature is that R recycles vectors if they are not the same length</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x8 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)
x8 <span class="op">+</span><span class="st"> </span><span class="dv">2</span></code></pre></div>
<pre><code>## [1] 3 4 5 6</code></pre>
<p>However, if one of the vectors is smaller, unexpected behaviour can happen, because R recycles elements regardless (so be careful, a warning is typically produced)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x9 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)
x10 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.7</span>,<span class="fl">0.9</span>,<span class="fl">1.3</span>)
x9 <span class="op">+</span><span class="st"> </span>x10</code></pre></div>
<pre><code>## [1] 3.7 4.9 6.3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x8 <span class="op">+</span><span class="st"> </span>x9</code></pre></div>
<pre><code>## Warning in x8 + x9: longer object length is not a multiple of shorter
## object length</code></pre>
<pre><code>## [1] 4 6 8 7</code></pre>
<p>Notice that a warning message was produced when <code>x8</code> and <code>x9</code> were added. Usually these messages are important and should be read! Quite often the answer to your current question lies in the previous error or warning message.</p>
<p>Another useful function is <code>rep</code>, which allows one to create repetitions of patterns. As examples, see the difference between the next two lines of code</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="dt">times=</span><span class="dv">3</span>)</code></pre></div>
<pre><code>##  [1] 1 2 3 4 1 2 3 4 1 2 3 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="dt">each=</span><span class="dv">3</span>)</code></pre></div>
<pre><code>##  [1] 1 1 1 2 2 2 3 3 3 4 4 4</code></pre>
<p>It is now time to end our first R session. At this point you need to decide what to do, as all objects created so far are in the memory, but this will be wiped out unless we explicitly save it to a file. The easiest way to do so is by calling the <code>save.image()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">save.image</span>(<span class="dt">file=</span><span class="st">&quot;my1stR.Rdata&quot;</span>)</code></pre></div>
<p>Note the unusual extension name <code>.Rdata</code> associated with R workspaces (an R file is called a workspace). We could now load up this workspace in a new R session, or typically we will load up that workspace by starting R by double clicking on the file created. Do this to see that you retrieve the above created objects. Note that if you already have an R session open, you can load up any previously saved workspace via function <code>load()</code>.</p>
<p>Note that you have saved your workspace in some directory but you have not defined it. By default, this is your working directory. You can check what that directory currently is by using the following command</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">getwd</span>()</code></pre></div>
<p>You can always change the directory you are working on by setting it up explicitly to your desired location, using</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#set the working directory - but remember to use your own path!!!</span>
<span class="kw">setwd</span>(<span class="st">&quot;C:/Users/myusername/Desktop/mycourse&quot;</span>)
<span class="co">#note how you can write comments in R by using &quot;#&quot;</span>
<span class="co">#anything in front of # is not interpreted by R</span>
<span class="co">#and treated as a comment</span>
<span class="co">#you should have the good habit of extensively commenting</span>
<span class="co">#all your code so that you know what you&#39;ve done</span>
<span class="co">#when you return to it even months or years later</span></code></pre></div>
<p>We have just started R, created and removed some objects, and used simple functions like <code>ls()</code>, <code>seq()</code> or <code>save()</code>. R is an object oriented language, and functions and vectors are just examples of types of objects available in R. In Section <a href="a-hands-on-introduction-to-r-tutorial.html#Types-classes">1.4</a> we go through the most common objects in R.</p>
</div>
<div id="Types-classes" class="section level2">
<h2><span class="header-section-number">1.4</span> Types and classes of objects</h2>
<p>Objects can have classes, which allow functions to interact with them. Objects can be of several classes. We already used the class <code>numeric</code>, which is used for general numbers, but there are also additional very commonly used classes</p>
<ul>
<li><code>integer</code>, for integer numbers</li>
<li><code>character</code>, just for character strings</li>
<li><code>factor</code>, used to represent levels of a categorical variable</li>
<li><code>logical</code>, the values TRUE and FALSE</li>
</ul>
<p>While many others exist, these are the more commonly used. Outputs of some analyses have special classes, as an example, the output of a call of function <code>lm()</code> is an object of class <code>lm</code>, i.e., a linear model. Typically, functions behave differently according to the class of an object. As an example, note how <code>summary()</code> treats differently an object of class <code>factor</code> or one of class <code>numeric</code>, producing a table of counts per level for a factor but a 6 number summary for numeric values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">obj1 &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;a&quot;</span>,<span class="dv">12</span>), <span class="kw">rep</span>(<span class="st">&quot;b&quot;</span>,<span class="dv">4</span>), <span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>,<span class="dv">2</span>)))
<span class="kw">summary</span>(obj1)</code></pre></div>
<pre><code>##  a  b  c 
## 12  4  2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">obj2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>,<span class="op">-</span><span class="fl">0.2</span>,<span class="dv">89</span>,<span class="dv">12</span>,<span class="op">-</span><span class="dv">3</span>,<span class="op">-</span><span class="fl">5.4</span>)
<span class="kw">summary</span>(obj2)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    -5.4    -1.6     2.0    14.2     8.5    89.0</code></pre>
<p>We can check the class of an object using function <code>class</code>, as in the following examples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(obj1)</code></pre></div>
<pre><code>## [1] &quot;factor&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(obj2)</code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(<span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] &quot;logical&quot;</code></pre>
<p>It is sometimes useful to coerce objects into different classes, but care should be used when doing so. Some examples are presented below. Can you describe in your own words what R did below?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.integer</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="op">-</span><span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.6</span>,<span class="fl">0.9</span>,<span class="fl">13.2</span>,<span class="dv">12</span>))</code></pre></div>
<pre><code>## [1]  3  0  0  0  0 13 12</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.numeric</span>(<span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">FALSE</span>,<span class="ot">TRUE</span>))</code></pre></div>
<pre><code>## [1] 1 0 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.numeric</span>(obj1)</code></pre></div>
<pre><code>##  [1] 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 3 3</code></pre>
<p>A common way to organize multiple vectors together is in the form of a matrix. Here we create such an object</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mat1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">4</span>)
mat1</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    4    7   10
## [2,]    2    5    8   11
## [3,]    3    6    9   12</code></pre>
<p>Note that by default R fills the first column (with 1,2,3) then the second column (4,5,6) etc. If you want it to fill the first row, then the second, you can use the optional argument <code>byrow=TRUE</code>, like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">4</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    2    3    4
## [2,]    5    6    7    8
## [3,]    9   10   11   12</code></pre>
<p>R also allows data structures with more than 2 dimensions – we don’t cover those here, but look up the help on <code>array</code> if you’re interested. A matrix is just a two dimensional array.</p>
<p>Arrays are useful objects, but can be complex to visualize due to their potential high dimensionality. Another common type of object is a <code>data.frame</code>. This is essentially a matrix but for which each column can be of a different type. These are what we would typically associate with an excel spreadsheet or a table in a database. Typically columns correspond to variables observed in a number of subjects, each subject recorded in its own row. A simple example with 3 variables and 5 subjects follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mysex &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;female&quot;</span>,<span class="st">&quot;female&quot;</span>,<span class="st">&quot;male&quot;</span>,<span class="st">&quot;male&quot;</span>)
myage &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">34</span>,<span class="dv">23</span>,<span class="dv">56</span>,<span class="dv">45</span>,<span class="dv">12</span>)
myhei &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">185</span>,<span class="dv">178</span>,<span class="dv">167</span>,<span class="dv">165</span>,<span class="dv">148</span>)
df1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID=</span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">sex=</span>mysex, <span class="dt">age=</span>myage, <span class="dt">height=</span>myhei)
df1</code></pre></div>
<pre><code>##   ID    sex age height
## 1  1   male  34    185
## 2  2 female  23    178
## 3  3 female  56    167
## 4  4   male  45    165
## 5  5   male  12    148</code></pre>
<p>Typically, <code>data.frames</code> are used to store the data we subsequently analyse. Usually the data are not manually imputed as above, but read into R from other software, using R functions addressed in a later section.</p>
<p>A data frame is just a special type of <code>list</code>. A <code>list</code> can contain objects of different types and dimensions. An example is here</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">list1 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">Note=</span><span class="st">&quot;whatever I want here&quot;</span>, <span class="dt">X2=</span><span class="dv">4</span>, <span class="dt">age=</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)
list1</code></pre></div>
<pre><code>## $Note
## [1] &quot;whatever I want here&quot;
## 
## $X2
## [1] 4
## 
## $age
## [1] 1 2 3 4</code></pre>
<p>Lists are typically used to store outputs of computations which require different kinds of objects to be recorded. Note the use of <code>$</code> to access the sub-components of a list or a data.frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">list1<span class="op">$</span>X2<span class="op">+</span><span class="dv">10</span></code></pre></div>
<pre><code>## [1] 14</code></pre>
<p>A final type of object which we already used are functions. While there are thousands of available functions inside R, later we will learn how to create our own functions.</p>
</div>
<div id="subsetting-data" class="section level2">
<h2><span class="header-section-number">1.5</span> Subsetting data</h2>
<p>One useful feature of R relates to how we can index subsets of data. The indexing information is included within square brackets:<code>[]</code>. As an example, we can select the third element of a vector</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">3.5</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="op">-</span><span class="dv">7</span>,<span class="fl">0.43</span>,<span class="op">-</span><span class="dv">1</span>)
x[<span class="dv">3</span>]</code></pre></div>
<pre><code>## [1] 7</code></pre>
<p>but we can also select all <em>except</em> the second and third elements of the same vector</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x[<span class="op">-</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)]</code></pre></div>
<pre><code>## [1]  1.00  8.00 -7.00  0.43 -1.00</code></pre>
<p>We can also select only the objects which follow a given condition, say only those that are positive</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x[x<span class="op">&gt;</span><span class="dv">0</span>]</code></pre></div>
<pre><code>## [1] 1.00 3.50 7.00 8.00 0.43</code></pre>
<p>or those between (-1,1)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x[(x<span class="op">&gt;-</span><span class="dv">1</span>) <span class="op">&amp;</span><span class="st"> </span>(x<span class="op">&lt;</span><span class="dv">1</span>)]</code></pre></div>
<pre><code>## [1] 0.43</code></pre>
<p>Note the subtle difference between the previous and next statements</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x[(x<span class="op">&gt;=-</span><span class="dv">1</span>) <span class="op">&amp;</span><span class="st"> </span>(x<span class="op">&lt;=</span><span class="dv">1</span>)]</code></pre></div>
<pre><code>## [1]  1.00  0.43 -1.00</code></pre>
<p>which reminds us we should be careful when setting these logical conditions, especially when working with integer boundaries which might be on the limits of those conditions. Note indexing can be done using additional information. As an example, we select here the elements in <code>x</code> such that the corresponding elements in <code>y</code> are positive:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#rnorm(k) produces k Gaussian random deviates</span>
x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>)
y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>)
x2 &lt;-<span class="st"> </span>x[y<span class="op">&gt;</span><span class="dv">0</span>]</code></pre></div>
<p>When working on a matrix the indexing is done by row and column, therefore for selecting the value that is in the third row and second column of a matrix we use</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mat1[<span class="dv">3</span>,<span class="dv">2</span>]</code></pre></div>
<pre><code>## [1] 6</code></pre>
<p>but we can also select all the elements in the second row</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mat1[<span class="dv">2</span>,]</code></pre></div>
<pre><code>## [1]  2  5  8 11</code></pre>
<p>or the fourth column</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mat1[,<span class="dv">4</span>]</code></pre></div>
<pre><code>## [1] 10 11 12</code></pre>
</div>
<div id="mathematical-functions-and-simple-data-calculations" class="section level2">
<h2><span class="header-section-number">1.6</span> Mathematical functions and simple data calculations</h2>
<p>Within R there are a number of mathematical operators but also mathematical and statistical functions. As any other functions, many of these have required parameters and optional parameters. It would take a very long time to describe even the most basic functions. Therefore, we prefer to let you try hands on explore a number of these.</p>
<p><strong>Task 1</strong>: Take your time to explore the functions below:</p>
<table>
<tbody>
<tr class="odd">
<td><code>sum(x)</code></td>
<td><code>sqrt(x)</code></td>
<td><code>log(x)</code></td>
<td><code>log(x,n)</code></td>
<td><code>exp(x)</code></td>
<td><code>choose(n,x)</code></td>
</tr>
<tr class="even">
<td><code>factorial(x)</code></td>
<td><code>floor(x)</code></td>
<td><code>ceiling(x)</code></td>
<td><code>round(x,digits)</code></td>
<td><code>abs(x)</code></td>
<td><code>cos(x)</code></td>
</tr>
<tr class="odd">
<td><code>sin(x)</code></td>
<td><code>tan(x)</code></td>
<td><code>acos(x)</code></td>
<td><code>acosh(x)</code></td>
<td><code>max(x)</code></td>
<td><code>min(x)</code></td>
</tr>
<tr class="even">
<td><code>mean(x)</code></td>
<td><code>median(x)</code></td>
<td><code>range(x)</code></td>
<td><code>var(x)</code></td>
<td><code>cor(x,y)</code></td>
<td><code>quantile(x)</code></td>
</tr>
</tbody>
</table>
<p>(Tip: do not forget that you can get a full description what each function can be used for, what arguments it takes, and what kind of output it produces, using “?”. Further, the help of most functions includes examples of their use, which proves invaluable to understand their usage.)</p>
</div>
<div id="importing-and-exporting-data" class="section level2">
<h2><span class="header-section-number">1.7</span> Importing and exporting data</h2>
<p>Rather than importing data into R manually, typically the data we work with are imported from some external source. Typically this might be some simple file format, like a txt or a csv file, but while not covered here, direct import from say Excel files or Access data bases is possible. Such more specialized inputs often require additional packages.</p>
<p>RStudio includes a useful dedicated shortcut “Import dataset”, by default available through the top right window of RStudio’s interface. Note this shortcut essentially just calls the appropriate functions required for each import. Here we present a couple of examples just for practising.</p>
<p>First, we load up a data frame which exists in R<a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a> and contains an example data set, with variables measured in 150 flowers of 3 varieties. This is in object <code>iris</code>, and we use the function <code>data()</code> to load it so that we have access to it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(iris)</code></pre></div>
<p>we can take a look at what this data set contains</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># example of head use: see the first 4 rows in iris</span>
<span class="kw">head</span>(iris, <span class="dt">n=</span><span class="dv">4</span>)</code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># example of str use</span>
<span class="kw">str</span>(iris)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    150 obs. of  5 variables:
##  $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
##  $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
##  $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
##  $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
##  $ Species     : Factor w/ 3 levels &quot;setosa&quot;,&quot;versicolor&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># example of summary use</span>
<span class="kw">summary</span>(iris)</code></pre></div>
<pre><code>##   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
##  Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
##  1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
##  Median :5.800   Median :3.000   Median :4.350   Median :1.300  
##  Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  
##  3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
##  Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  
##        Species  
##  setosa    :50  
##  versicolor:50  
##  virginica :50  
##                 
##                 
## </code></pre>
<p>Now we create a new data frame which we then modify to include a new variable</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata &lt;-<span class="st"> </span>iris
mydata<span class="op">$</span>total &lt;-<span class="st"> </span>mydata<span class="op">$</span>Sepal.Length <span class="op">+</span><span class="st"> </span>mydata<span class="op">$</span>Sepal.Width <span class="op">+</span><span class="st"> </span>mydata<span class="op">$</span>Petal.Length <span class="op">+</span><span class="st"> </span>mydata<span class="op">$</span>Petal.Width</code></pre></div>
<p>Now, we are going to export this data set as a txt, named <code>mydatafile.txt</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write.table</span>(mydata, <span class="dt">file=</span><span class="st">&quot;mydatafile.txt&quot;</span>, <span class="dt">row.names=</span><span class="ot">FALSE</span>)</code></pre></div>
<p>Note the use of the optional argument <code>row.names=FALSE</code>, otherwise some arbitrary row names would be added to the file. If you look in the folder you are working in, you should now have a new file there. Open it and check that it looks as you would expect. Next, we are going to import it back into R, into an object named <code>indat</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">indat &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">file=</span><span class="st">&quot;mydatafile.txt&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>)</code></pre></div>
<p>So now we have our data back in R.</p>
<p><strong>Task 2</strong>: Import the file <code>dados1.csv</code> into R, giving it the name <code>newfile</code>. Tips: Explore the possible options including 1. <code>Import Dataset</code> shortcut in the <code>Environment tab</code>, 2. the optional argument <code>sep=&quot;,&quot;</code> in function <code>read.table</code> or 3. consider using function <code>read.csv()</code>.</p>
</div>
<div id="graphics" class="section level2">
<h2><span class="header-section-number">1.8</span> Graphics</h2>
<p>One of the most amazing R capabilities are its graphics customization properties. One can create pretty much any graphic output desirable. The plot function is, as we have seen before for function <code>summary()</code>, a function that attempts to do something smart depending on the type of arguments used. Using the data set iris previously considered, plot examples are implemented below, with some optional arguments being used to show some of the possibilities to customize plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#default use</span>
<span class="kw">plot</span>(indat<span class="op">$</span>Sepal.Length)</code></pre></div>
<p><img src="_main_files/figure-html/simpleplot-1.png" width="672" /></p>
<p>We now add some labels to a new plot of sepal length as a function of species (note the use of <code>~</code> to mean <em>as a function of</em>; this is also used below when specifying regression models, where the object on the left of <code>~</code> will be the response variable and the objects on the right explanatory variables)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ys &lt;-<span class="st"> </span>indat<span class="op">$</span>Sepal.Length
xs &lt;-<span class="st"> </span>indat<span class="op">$</span>Species
<span class="co">#note use of ~ to represent &quot;as a function of&quot;</span>
<span class="kw">plot</span>(ys<span class="op">~</span>xs, <span class="dt">ylab=</span><span class="st">&quot;Sepal Length (in mm)&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Sepal length by species&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/flowerplot-1.png" width="672" /></p>
<p>We can also set the graphic window to hold multiple plots. This is obtained via argument <code>mfrow</code>, one of the arguments in function <code>par</code>.<a href="#fn5" class="footnoteRef" id="fnref5"><sup>5</sup></a> An example follows, in which we leverage on the use of function <code>with</code> to avoid having to constantly use <code>indat$</code> to tell R where the data can be found.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#define two rows and 2 columns of plots</span>
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>))
<span class="kw">with</span>(indat, <span class="kw">hist</span>(Sepal.Length, <span class="dt">main=</span><span class="st">&quot;&quot;</span>))
<span class="kw">with</span>(indat, <span class="kw">hist</span>(Sepal.Width, <span class="dt">main=</span><span class="st">&quot;&quot;</span>))
<span class="kw">with</span>(indat, <span class="kw">hist</span>(Petal.Length, <span class="dt">main=</span><span class="st">&quot;&quot;</span>))
<span class="kw">with</span>(indat, <span class="kw">hist</span>(Petal.Width, <span class="dt">main=</span><span class="st">&quot;&quot;</span>))
<span class="kw">with</span>(indat, <span class="kw">plot</span>(Petal.Length, Petal.Width, <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">col=</span><span class="dv">12</span>, <span class="dt">bg=</span><span class="dv">3</span>))
<span class="kw">with</span>(indat, <span class="kw">plot</span>(Sepal.Length, Sepal.Width, <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">col=</span><span class="dv">3</span>))</code></pre></div>
<p><img src="_main_files/figure-html/plot2col-1.png" width="672" /></p>
<p>We used argument <code>mfrow</code>, but looking at the help for function `par gives you an insight to the level of customization one can reach with respect to these graphical parameters, via dozens of different arguments.</p>
<p>We can look at the correlation structure between all variables using function <code>pairs()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define two rows and 2 columns of plots</span>
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))
<span class="kw">pairs</span>(indat)</code></pre></div>
<p><img src="_main_files/figure-html/pairs-1.png" width="672" /></p>
<p><strong>Task 3</strong>: Using data <code>cars</code>, create a plot that represents the stopping distances as a function of the speed of cars. Use the <code>points</code> function to add a special symbol to points corresponding to cars with speed lower than 15 mph, but distance larger than 70m. Check out the function <code>text</code> to add text annotations to plots. Customize axis labels.</p>
</div>
<div id="extending-basic-capabilities-via-packages" class="section level2">
<h2><span class="header-section-number">1.9</span> Extending basic capabilities via packages</h2>
<p>While R base installation includes enough functions that getting acquainted with them could take several years, many more are available via the installation of additional packages available online. A package is just a set of functions and data sets (and the corresponding documentation plus some additional required files) which usually have some specific goal. As examples, in our workshop we will be using packages <code>secr</code> and <code>mgcv</code>, which allow the implementation of spatially explicit capture recapture (SECR) models and generalized additive models (GAM), respectively.</p>
<p>Note packages cover a very wide range of applications, and chances are that at least a package, often more than one, already exists to implement most kinds of statistical or data processing tasks we might imagine.</p>
<p>Installing a new package in R requires a call to function <code>install.packages()</code>. A RStudio shortcut is simply to follow the <code>Tools|Install packages...</code> shortcut.</p>
<p>After a package is installed it needs to be loaded to be available. In R this is done calling function <code>library()</code> with the package name as an argument. In RStudio this becomes simpler by checking the boxes under the RStudio tab packages (by default this tab is available on the bottom right window, along with the Files, Plots, Help and Viewer tabs).</p>
<p>We use <code>secr</code> as an example. Notice, to begin with <code>secr</code> is not available</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">?secr</code></pre></div>
<pre><code>## No documentation for &#39;secr&#39; in specified packages and libraries:
## you could try &#39;??secr&#39;</code></pre>
<p>Next, we install the package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;secr&quot;</span>)</code></pre></div>
<p>Then, we load the package</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;secr&quot;</span>)</code></pre></div>
<pre><code>## This is secr 3.0.1. For overview type ?secr</code></pre>
<p>and finally we check that the functions in it are now loaded</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">?secr</code></pre></div>
<p>We would now be ready to analyse results from a SECR survey.</p>
<p><strong>Task 4</strong>: Run the example code available in the help page from package <code>secr</code>. Try to understand what is happening: we simulate some SECR data and we then estimate density based on simulated capture histories. In particular, look at the simulated density and the estimated density. This is just a taster for the course to follow…!</p>
</div>
<div id="linear-regression" class="section level2">
<h2><span class="header-section-number">1.10</span> Linear regression</h2>
<p>One of the most common type of data analysis is a regression model. Despite common and conceptually simple, it is a very powerful way to understand which (and how) of a number of candidate variables, sometimes referred to covariates, independent or explanatory variables, might influence a dependent variable, also often referred as the response. There are many flavours of regression models, from a simple linear regression to complicated generalized additive mixed models. We do not wish to present these in any detail, but to introduce you to some functions that implement these models and the syntax that R uses to describe them.</p>
<p>Let’s start with the basics. You have used the <code>cars</code> data set above. We use it here again to try to explain the distance a car takes to stop as a function of its speed. We start with a linear model using function <code>lm()</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(cars)
mylm1 &lt;-<span class="st"> </span><span class="kw">lm</span>(dist<span class="op">~</span>speed, <span class="dt">data=</span>cars)</code></pre></div>
<p>We have stored the result of fitting the model in object <code>mylm1</code>. The function <code>summary()</code> can be used to print a summary of the fit</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(mylm1)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dist ~ speed, data = cars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -29.069  -9.525  -2.272   9.215  43.201 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -17.5791     6.7584  -2.601   0.0123 *  
## speed         3.9324     0.4155   9.464 1.49e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 15.38 on 48 degrees of freedom
## Multiple R-squared:  0.6511, Adjusted R-squared:  0.6438 
## F-statistic: 89.57 on 1 and 48 DF,  p-value: 1.49e-12</code></pre>
<p>Do not get frightened about all the output. The coefficient associated with speed tells us what intuition alone would anticipate, the higher the speed, the larger the distance a car takes to stop. The easier way to see the relationship is by adding a line to the plot (note this is a similar plot to what you should have created in task 3 above!). The predicted relationship is shown in Figure <a href="a-hands-on-introduction-to-r-tutorial.html#fig:plotreg">1.1</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xl &lt;-<span class="st"> &quot;Speed (mph)&quot;</span>
yl &lt;-<span class="st"> &quot;Distance (m)&quot;</span>
<span class="kw">plot</span>(cars<span class="op">$</span>speed, cars<span class="op">$</span>dist, <span class="dt">xlab=</span>xl, <span class="dt">ylab=</span>yl, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">120</span>) ,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">30</span>))
<span class="kw">abline</span>(mylm1)</code></pre></div>
<div class="figure"><span id="fig:plotreg"></span>
<img src="_main_files/figure-html/plotreg-1.png" alt="The data and the linear fit added to it." width="672" />
<p class="caption">
Figure 1.1: The data and the linear fit added to it.
</p>
</div>
<p>Note how function <code>abline()</code> is used with a linear model as its first argument and it uses the parameters in said object to add a line to the plot. The optional arguments <code>v</code> and <code>h</code> are often very useful to draw vertical and horizontal lines in plots.</p>
<p><strong>Task 5</strong>: Use abline to draw dashed lines (tip, use optional argument <code>lty=2</code>) representing the estimated distance that a car moving at 16 mph would take to stop.</p>
<p>Note that the line added to the plot represents the distance a car would take to stop given its speed. Oddly enough, it seems like a car going at 3 mph might take a negative time to stop, which is just plain nonsense. Why? Because we used a model which does not respect the features of the data. A stopping distance can not be negative. However, implicit in the linear model we used, distance is a Gaussian (=normal) random variable. We can avoid this by using a generalized linear model (GLM). Now the response can have a range of distributions. An example of such distribution that takes only positive values is the gamma distribution. We implement a gamma GLM next</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#fit the glm</span>
myglm1 &lt;-<span class="st"> </span><span class="kw">glm</span>(dist<span class="op">~</span>speed, <span class="dt">data=</span>cars, <span class="dt">family=</span><span class="kw">Gamma</span>(<span class="dt">link=</span>log))
<span class="co">#predict using the glm for speeds between 1 and 30</span>
predmyglm1 &lt;-<span class="st"> </span><span class="kw">predict.glm</span>(myglm1, <span class="dt">newdata=</span><span class="kw">data.frame</span>(<span class="dt">speed=</span><span class="dv">1</span><span class="op">:</span><span class="dv">30</span>), 
                          <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</code></pre></div>
<p>Our model now assumes the response has a gamma distribution, and the link function is the logarithm. The link function allows you to change how the mean value is related to the covariates. This becomes rather technical rather fast. Details about glms are naturally beyond the scope of this tutorial. References like <span class="citation">Faraway (<a href="#ref-Faraway2006">2006</a>)</span> or <span class="citation">Zuur et al. (<a href="#ref-Zuur2009b">2009</a>)</span> will provide further details in an applied context. The predicted relationship is shown in Figure <a href="a-hands-on-introduction-to-r-tutorial.html#fig:plotgam">1.2</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#create a plot</span>
<span class="kw">plot</span>(cars<span class="op">$</span>speed,cars<span class="op">$</span>dist, <span class="dt">xlab=</span><span class="st">&quot;Speed (mph)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Distance (m)&quot;</span>, 
     <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">120</span>), <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">30</span>))
<span class="co">#add the linear fit</span>
<span class="kw">abline</span>(mylm1)
<span class="co">#and now add the glm predictions</span>
<span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, predmyglm1, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">lty=</span><span class="dv">3</span>)</code></pre></div>
<div class="figure"><span id="fig:plotgam"></span>
<img src="_main_files/figure-html/plotgam-1.png" alt="The data and the linear and Gamma glm fits added to it." width="672" />
<p class="caption">
Figure 1.2: The data and the linear and Gamma glm fits added to it.
</p>
</div>
<p>However, this glm still requires that the response is linear at some scale (in this case, on the scale of the link function). Sometimes, non-linear effects are present. These can be fitted using generalized additive models. A good introduction to GAMs is provided by <span class="citation">Wood (<a href="#ref-Wood2006">2006</a>)</span> and <span class="citation">Zuur et al. (<a href="#ref-Zuur2009b">2009</a>)</span>.</p>
<p>So finally we fit a gam model to the same data set. For that we require library <code>mgcv</code>. The outcome is shown in Figure <a href="a-hands-on-introduction-to-r-tutorial.html#fig:gamfitplot">1.3</a>. Here the fit is not very different from the glm fit, but under many circumstances a gam might be required over a glm. We will see such an example in the next few days, when we model the detectability of beaked whale clicks as a function of distance and angle (with respect to hydrophones).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#load the mgcv library</span>
<span class="kw">library</span>(mgcv)</code></pre></div>
<pre><code>## Loading required package: nlme</code></pre>
<pre><code>## This is mgcv 1.8-17. For overview type &#39;help(&quot;mgcv-package&quot;)&#39;.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#fit the gam</span>
mygam1 &lt;-<span class="st"> </span><span class="kw">gam</span>(dist<span class="op">~</span><span class="kw">s</span>(speed), <span class="dt">data=</span>cars, <span class="dt">family=</span><span class="kw">Gamma</span>(<span class="dt">link=</span>log))
<span class="co">#predict using the glm for speeds between 1 and 30</span>
predmygam1 &lt;-<span class="st"> </span><span class="kw">predict</span>(mygam1, <span class="dt">newdata=</span><span class="kw">data.frame</span>(<span class="dt">speed=</span><span class="dv">1</span><span class="op">:</span><span class="dv">30</span>), <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#create a plot</span>
<span class="kw">plot</span>(cars<span class="op">$</span>speed, cars<span class="op">$</span>dist, <span class="dt">xlab=</span><span class="st">&quot;Speed (mph)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Distance (m)&quot;</span>, 
     <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">120</span>), <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">30</span>))
<span class="co">#add the linear fit</span>
<span class="kw">abline</span>(mylm1)
<span class="co">#and now add the glm predictions</span>
<span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, predmyglm1, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">lty=</span><span class="dv">3</span>)
<span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, predmygam1, <span class="dt">col=</span><span class="st">&quot;green&quot;</span>, <span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">lty=</span><span class="dv">2</span>)</code></pre></div>
<div class="figure"><span id="fig:gamfitplot"></span>
<img src="_main_files/figure-html/gamfitplot-1.png" alt="The data and the linear and Gamma glm and gam fits added to it." width="672" />
<p class="caption">
Figure 1.3: The data and the linear and Gamma glm and gam fits added to it.
</p>
</div>
</div>
<div id="some-advanced-capabilities-of-r" class="section level2">
<h2><span class="header-section-number">1.11</span> Some advanced capabilities of R</h2>
<div id="simulation-and-random-number-generation" class="section level3">
<h3><span class="header-section-number">1.11.1</span> Simulation and random number generation</h3>
<p>Another powerful use of R is for simulation. To this end, R has the ability to simulate random deviates from a large number of distributions. Perhaps the more useful and commonly used are the uniform and the Gaussian distributions. We now create 50 random deviates from each of these, as well as some Poisson deviates, for illustration</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#define two rows and 2 columns of plots</span>
rdnorm &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">50</span>,<span class="dt">mean=</span><span class="dv">20</span>,<span class="dt">sd=</span><span class="dv">3</span>)
rdunif &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">50</span>,<span class="dt">min=</span><span class="dv">3</span>,<span class="dt">max=</span><span class="dv">6</span>)
rdpois &lt;-<span class="st"> </span><span class="kw">rpois</span>(<span class="dv">50</span>,<span class="dt">lambda=</span><span class="dv">6</span>)</code></pre></div>
<p>R can create random numbers from many different distributions (see help(Distributions) for a list) – the relevant functions generally start with r and then an abbreviated distribution name (rbinom, rexp, rgeom, etc). Additionally, R also includes the ability to obtain the density function, distribution function and quantile function via the <code>d</code>+name, <code>p</code>+name and <code>q</code>+name functions. As an example, the Gaussian function usage of these functions is presented below</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dnorm</span>(<span class="dv">0</span>,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)</code></pre></div>
<pre><code>## [1] 0.3989423</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pnorm</span>(<span class="dv">0</span>,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)</code></pre></div>
<pre><code>## [1] 0.5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qnorm</span>(<span class="fl">0.975</span>,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)</code></pre></div>
<pre><code>## [1] 1.959964</code></pre>
<p><strong>Task 6</strong>: Using what you have learnt here, create two histograms, one of 50, another of 5000, random deviates from a Gaussian distribution, using the optional argument <code>freq=FALSE</code> (leading to an estimate of the density function). Then add a line to the plot that represents the true underlying density (tip, you can use function <code>dnorm()</code>), and comment on the results.</p>
</div>
<div id="writing-your-own-functions" class="section level3">
<h3><span class="header-section-number">1.11.2</span> Writing your own functions</h3>
<p>While the above functions, and the many more available, make R a very useful tool, there are sometimes problems which require a special tool. For these, we can create our own functions. Note this is an advanced topic.</p>
<p>The way of doing that follows a specific syntax</p>
<pre><code>&gt; name &lt;- function(arg1,arg2,...) {what the function does goes here}</code></pre>
<p>As an example, we create a function that returns the sum of its arguments:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myfun &lt;-<span class="st"> </span><span class="cf">function</span>(i,j){
  myres &lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span>j
  <span class="kw">return</span>(myres)
}</code></pre></div>
<p><strong>Task 7</strong>: create a function called <code>mystats()</code> which returns the mean, variance, maximum and minimum of the first argument (a vector). Then, update your function such that it can also return the mean excluding the negative numbers.</p>
</div>
</div>
<div id="wrap-up" class="section level2">
<h2><span class="header-section-number">1.12</span> Wrap up</h2>
<p>A full introduction to R course could take an entire week. A full course in regression modelling with R could take an entire semester. A full course of data analysis in R could take a life time.</p>
<p>Our objective with this tutorial was simply to introduce you to R such that when we use R in the next few days, the commands do not look too esoteric. Nonetheless, this material as well as the references provided should constitute a good basis to learn R further if you so desire. Beginners find the learning curve is often steep, but once mastered, R simplifies enormously the task of statistical data analysis.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#cleaning the workspace</span>
<span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</code></pre></div>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Faraway2006">
<p>Faraway, J. J. 2006. <em>Extending the Linear Model with R</em>. Chapman &amp; Hall / CRC. <a href="http://www.maths.bath.ac.uk/%7Ejjf23/ELM/">http://www.maths.bath.ac.uk/%7Ejjf23/ELM/</a>.</p>
</div>
<div id="ref-Zuur2009b">
<p>Zuur, Alain F., Elena N. Ieno, Neil Walker, Anatoly A. Saveliev, and Graham M. Smith. 2009. <em>Mixed Effects Models and Extensions in Ecology with R</em>. Springer.</p>
</div>
<div id="ref-Wood2006">
<p>Wood, Simon N. 2006. <em>Generalized Additive Models: An Introduction with R</em>. CRC/Chapman &amp; Hall.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>If this fails, you might have to first associate .Rdata files with RStudio.<a href="a-hands-on-introduction-to-r-tutorial.html#fnref1">↩</a></p></li>
<li id="fn2"><p>All the tab positions are the RStudio defaults, but this can be customized by the user later.<a href="a-hands-on-introduction-to-r-tutorial.html#fnref2">↩</a></p></li>
<li id="fn3"><p>Past experience tells us that more than one person will have problems because they forgot to delete a “&gt;” and/or “+” from the code below when they copy paste the code into their own R sessions. Avoid being that person!<a href="a-hands-on-introduction-to-r-tutorial.html#fnref3">↩</a></p></li>
<li id="fn4"><p>R includes a large variety of example data sets which are useful to illustrate the use of code.<a href="a-hands-on-introduction-to-r-tutorial.html#fnref4">↩</a></p></li>
<li id="fn5"><p>Note this function controls a much larger number of graphical parameters. You can take a look at its help file to get a feel for how many and what kind of control it allows you.<a href="a-hands-on-introduction-to-r-tutorial.html#fnref5">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="analyse-simulated-data-set.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
